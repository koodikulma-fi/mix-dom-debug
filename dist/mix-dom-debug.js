var e=require('data-signals'),t=require('mix-dom'),o=require('mix-dom/camelCase'),i=require('dom-types'),n=require('data-memo');const s='1.0.3',l={'':null,expanded:t.MixDOM.def('svg',{viewBox:'0 0 10 10'},t.MixDOM.def('path',{d:'M 2.5,4 L 5,6 L 7.5,4',fill:'none',stroke:'currentColor','stroke-width':'1.5','stroke-linejoin':'round','stroke-linecap':'round'})),collapsed:t.MixDOM.def('svg',{viewBox:'0 0 10 10'},t.MixDOM.def('path',{d:'M 4,2.5 L 6,5 L 4,7.5',fill:'none',stroke:'currentColor','stroke-width':'1.5','stroke-linejoin':'round','stroke-linecap':'round'})),back:t.MixDOM.def('svg',{viewBox:'0 0 768 768'},t.MixDOM.def('path',{d:'M658.8,527.9c14.4,0,26.2-11.8,26.2-26.1V292.3c0-14.4-11.8-26.2-26.2-26.2H397V135.2c0-10.6-6.4-20.1-16.2-24.2 c-9.7-4-21-1.8-28.5,5.7L90.5,378.5c-10.1,10.2-10.1,26.9,0,37l261.8,261.8c4.9,5.1,11.6,7.7,18.5,7.7c3.3,0,6.7-0.7,10-2 c9.8-4.1,16.2-13.6,16.2-24.2V527.9H658.8L658.8,527.9z',fill:'currentColor'})),forwards:t.MixDOM.def('svg',{viewBox:'0 0 768 768'},t.MixDOM.def('path',{d:'M109.1,527.9h261.8v130.9c0,10.6,6.4,20.1,16.2,24.2c3.3,1.3,6.7,2,10,2c6.9,0,13.6-2.6,18.5-7.7l261.8-261.8 c10.1-10.1,10.1-26.8,0-37L415.6,116.7c-7.5-7.5-18.8-9.7-28.5-5.7c-9.8,4.1-16.2,13.6-16.2,24.2v130.9H109.1 c-14.4,0-26.2,11.8-26.2,26.2v209.5C82.9,516.1,94.7,527.9,109.1,527.9L109.1,527.9z',fill:'currentColor'})),console:t.MixDOM.def('svg',{viewBox:'0 0 10 10'},t.MixDOM.def('path',{d:'M 2,3 L 4,5 L 2,7',fill:'none',stroke:'currentColor','stroke-width':'1.5','stroke-linejoin':'round','stroke-linecap':'round'}),t.MixDOM.def('line',{x1:'6',x2:'8.5',y1:'8',y2:'8',stroke:'currentColor','stroke-width':'1.5','stroke-linejoin':'round','stroke-linecap':'round'})),theme:t.MixDOM.def('svg',{viewBox:'0 0 768 768'},t.MixDOM.def('path',{d:'M386.4,50.2c-184.5,0-334,149.5-334,334s149.5,334,334,334c59.1,0,84.8-81,36.6-114.1c-29.8-20.5,18.2-83.2,70.4-83.2 c79.9,0,227,12.7,227-136.7C720.4,199.8,570.9,50.2,386.4,50.2z M148.4,401.8c-22.6,0-40.9-18.3-40.9-40.9s18.3-40.9,40.9-40.9 c22.6,0,40.9,18.3,40.9,40.9S171,401.8,148.4,401.8z M217.6,272.9c-26.2,0-47.5-21.2-47.5-47.5c0-26.2,21.2-47.5,47.5-47.5 c26.2,0,47.5,21.2,47.5,47.5C265.1,251.7,243.8,272.9,217.6,272.9z M358.6,209c-29.9,0-54.1-24.2-54.1-54.1 c0-29.9,24.2-54.1,54.1-54.1c29.9,0,54.1,24.2,54.1,54.1C412.6,184.8,388.4,209,358.6,209z M521.1,262.2c-32.1,0-58.1-26-58.1-58.1 s26-58.1,58.1-58.1c32.1,0,58.1,26,58.1,58.1S553.2,262.2,521.1,262.2z M613.1,427.1c-34.6,0-62.6-28-62.6-62.6s28-62.6,62.6-62.6 c34.6,0,62.6,28,62.6,62.6S647.7,427.1,613.1,427.1z',fill:'currentColor'})),close:t.MixDOM.def('svg',{viewBox:'0 0 16 16'},t.MixDOM.def('path',{d:'M10.1,8L13,5.1c0.6-0.6,0.6-1.5,0-2.1c-0.6-0.6-1.5-0.6-2.1,0L8,5.9L5.1,3C4.5,2.4,3.6,2.4,3,3C2.4,3.6,2.4,4.5,3,5.1L5.9,8 L3,10.9c-0.6,0.6-0.6,1.5,0,2.1c0.3,0.3,0.7,0.4,1.1,0.4s0.8-0.1,1.1-0.4L8,10.1l2.9,2.9c0.3,0.3,0.7,0.4,1.1,0.4s0.8-0.1,1.1-0.4 c0.6-0.6,0.6-1.5,0-2.1L10.1,8z',fill:'currentColor'})),info:t.MixDOM.def('svg',{viewBox:'0 0 16 16'},t.MixDOM.def('path',{d:'M8,15.2c-1,0-1.7-0.8-1.7-1.7v-6H4.9c0-1,1.1-1.7,3.1-1.7c1,0,1.7,0.8,1.7,1.7v6H11C11.1,14.5,9.7,15.2,8,15.2z',fill:'currentColor'}),t.MixDOM.def('circle',{cx:'8',cy:'2.6',r:'1.7',fill:'currentColor'})),'show-all':t.MixDOM.def('svg',{viewBox:'0 0 768 768'},t.MixDOM.def('path',{d:'M384 134.4c-177.6 0-331.2 139.2-331.2 249.6s158.4 249.6 331.2 249.6c182.4 0 331.2-153.6 331.2-249.6s-148.8-249.6-331.2-249.6zM384 576c-158.4 0-273.6-124.8-273.6-192s115.2-192 273.6-192c153.6 0 273.6 134.4 273.6 192s-120 192-273.6 192z M384 244.8c-67.2 0-124.8 62.4-124.8 139.2s57.6 139.2 124.8 139.2 124.8-62.4 124.8-139.2-57.6-139.2-124.8-139.2z',fill:'currentColor'})),'show-matched':t.MixDOM.def('svg',{viewBox:'0 0 768 768'},t.MixDOM.def('path',{d:'M744 158.4c-14.4-24-43.2-28.8-67.2-14.4l-91.2 57.6c-52.8-38.4-124.8-67.2-201.6-67.2-177.6 0-331.2 139.2-331.2 249.6 0 38.4 19.2 81.6 52.8 120l-62.4 38.4c-24 14.4-28.8 43.2-14.4 67.2 9.6 14.4 24 24 38.4 24 9.6 0 19.2 0 24-9.6l86.4-52.8c57.6 38.4 129.6 62.4 201.6 62.4 182.4 0 331.2-153.6 331.2-249.6 0-33.6-19.2-76.8-52.8-115.2l67.2-43.2c28.8-14.4 33.6-48 19.2-67.2zM110.4 384c0-67.2 115.2-192 273.6-192 57.6 0 105.6 19.2 148.8 43.2l-374.4 235.2c-28.8-28.8-48-62.4-48-86.4zM657.6 384c0 57.6-120 192-273.6 192-57.6 0-105.6-14.4-148.8-38.4l72-43.2c38.4 33.6 86.4 43.2 134.4 19.2 48-28.8 72-86.4 67.2-144l100.8-67.2c28.8 28.8 48 62.4 48 81.6z',fill:'currentColor'})),'scroll-to':t.MixDOM.def('svg',{viewBox:'0 0 768 768'},t.MixDOM.def('path',{d:'M368.2,704.9c9,9,23.5,9,32.4-0.1l182.8-185.4c14.3-14.4,4.1-38.9-16.3-38.9h-83.4V266.6c0-13.7-11.2-24.9-24.9-24.9H309.6 c-13.7,0-24.9,11.2-24.9,24.9v213.8H199c-20.4,0-30.6,24.6-16.2,39L368.2,704.9z M304.7,202h159.1c10.9,0,19.9-9,19.9-19.9c0-10.9-9-19.9-19.9-19.9H304.7c-10.9,0-19.9,9-19.9,19.9 C284.8,193,293.7,202,304.7,202z M304.7,122.4h159.1c10.9,0,19.9-9,19.9-19.9s-9-19.9-19.9-19.9H304.7c-10.9,0-19.9,9-19.9,19.9S293.7,122.4,304.7,122.4z',fill:'currentColor'})),'select-all':t.MixDOM.def('svg',{viewBox:'0 0 768 768'},t.MixDOM.def('path',{d:'M128,96c-17.7,0-32,14.3-32,32v512c0,17.7,14.3,32,32,32h512c17.7,0,32-14.3,32-32V128c0-17.7-14.3-32-32-32H128z M608,608 H160V160h448V608z M327.4,500.5c6.1,7.3,15.1,11.5,24.6,11.5c0.3,0,0.5,0,0.8,0c9.8-0.2,18.9-5,24.8-12.8l144-192 c10.6-14.1,7.7-34.2-6.4-44.8c-14.1-10.6-34.2-7.7-44.8,6.4L350.7,428.4l-54.1-64.9c-11.3-13.6-31.5-15.4-45.1-4.1 c-13.6,11.3-15.4,31.5-4.1,45.1L327.4,500.5z',fill:'currentColor'})),'select-none':t.MixDOM.def('svg',{viewBox:'0 0 768 768'},t.MixDOM.def('path',{d:'M640,96H128c-17.7,0-32,14.3-32,32v512c0,17.7,14.3,32,32,32h512c17.7,0,32-14.3,32-32V128C672,110.3,657.7,96,640,96z  M556,288L376,528c-7.4,9.8-18.8,15.8-31,16c-0.4,0-0.6,0-1,0c-11.9,0-23.1-5.3-30.8-14.4l-100-120c-14.1-17-11.9-42.3,5.1-56.4 c17-14.1,42.3-11.9,56.4,5.1l67.6,81.1L492,240c13.3-17.6,38.4-21.3,56-8C565.7,245.2,569.3,270.4,556,288z',fill:'currentColor'})),'no-selection':t.MixDOM.def('svg',{viewBox:'0 0 768 768'},t.MixDOM.def('path',{d:'M543.7,352C438,352,352,438,352,543.7s86,191.7,191.7,191.7s191.7-86,191.7-191.7S649.5,352,543.7,352z M543.7,416 c23.6,0,45.8,6.5,64.8,17.7L433.7,608.5c-11.2-19-17.7-41.2-17.7-64.8C416,473.3,473.3,416,543.7,416z M543.7,671.5 c-23.6,0-45.8-6.5-64.8-17.7l174.8-174.8c11.2,19,17.7,41.2,17.7,64.8C671.5,614.2,614.2,671.5,543.7,671.5z',fill:'currentColor'}),t.MixDOM.def('path',{d:'M54,32c-12.2,0-22,9.8-22,22v308c0,12.2,9.8,22,22,22h308c12.2,0,22-9.8,22-22V54c0-12.2-9.8-22-22-22H54z M326.7,147.2 L202.5,312.9c-5.1,6.8-12.9,10.8-21.4,11c-0.2,0-0.5,0-0.7,0c-8.2,0-16-3.6-21.2-9.9l-69-82.8c-9.8-11.7-8.2-29.1,3.5-38.9 c11.7-9.8,29.1-8.2,38.9,3.5l46.7,56l103.3-137.7c9.1-12.2,26.4-14.7,38.6-5.5C333.4,117.7,335.8,135,326.7,147.2z',fill:'currentColor'})),'no-filter':t.MixDOM.def('svg',{viewBox:'0 0 768 768'},t.MixDOM.def('path',{d:'M543.7,352C438,352,352,438,352,543.7s86,191.7,191.7,191.7s191.7-86,191.7-191.7S649.5,352,543.7,352z M543.7,416 c23.6,0,45.8,6.5,64.8,17.7L433.7,608.5c-11.2-19-17.7-41.2-17.7-64.8C416,473.3,473.3,416,543.7,416z M543.7,671.5 c-23.6,0-45.8-6.5-64.8-17.7l174.8-174.8c11.2,19,17.7,41.2,17.7,64.8C671.5,614.2,614.2,671.5,543.7,671.5z',fill:'currentColor'}),t.MixDOM.def('path',{d:'M288.5,282.4v191.2c1,7.3-1.5,15-7,20.1c-9.5,9.5-24.7,9.5-34.2,0L198.5,445c-5.6-5.6-8-13.1-7-20.1V282.4h-0.7L51,103.3 c-8.2-10.4-6.3-25.7,4.1-34c4.6-3.4,9.7-5.3,15-5.3h339.7c5.3,0,10.4,1.9,15,5.3c10.4,8.2,12.4,23.5,4.1,34L289.3,282.4H288.5 L288.5,282.4z',fill:'currentColor'})),'click-select':t.MixDOM.def('svg',{viewBox:'0 0 768 768'},t.MixDOM.def('path',{d:'M734.1,603.7L508.8,326.4c-4.6-5.7-12.3-7.9-19.3-5.4c-6.9,2.5-11.5,9-11.5,16.3v312c0,6,3.1,11.6,8.2,14.7 c2.8,1.7,5.9,2.6,9.1,2.6c2.6,0,5.3-0.6,7.8-1.8l51.5-25.7l28.3,85c2.4,7.1,9,11.9,16.4,11.9h69.3c5.6,0,10.8-2.7,14.1-7.2 c3.3-4.5,4.1-10.3,2.4-15.6L658,632h62.6c6.7,0,12.8-3.8,15.7-9.9C739.2,616.1,738.3,608.9,734.1,603.7z',fill:'currentColor'}),t.MixDOM.def('path',{d:'M394.7,32H53.3C41.5,32,32,41.5,32,53.3v341.3c0,11.8,9.5,21.3,21.3,21.3h341.3c11.8,0,21.3-9.5,21.3-21.3V53.3 C416,41.5,406.5,32,394.7,32z M338.7,160l-120,160c-4.9,6.5-12.5,10.5-20.7,10.7c-0.3,0-0.4,0-0.7,0c-7.9,0-15.4-3.5-20.5-9.6 l-66.7-80c-9.4-11.3-7.9-28.2,3.4-37.6c11.3-9.4,28.2-7.9,37.6,3.4l45.1,54.1L296,128c8.9-11.7,25.6-14.2,37.3-5.3 C345.1,131.5,347.5,148.3,338.7,160z',fill:'currentColor'})),'click-select-tip':t.MixDOM.def('svg',{viewBox:'0 0 768 768'},t.MixDOM.def('path',{d:'M734.1,603.7L508.8,326.4c-4.6-5.7-12.3-7.9-19.3-5.4c-6.9,2.5-11.5,9-11.5,16.3v312c0,6,3.1,11.6,8.2,14.7 c2.8,1.7,5.9,2.6,9.1,2.6c2.6,0,5.3-0.6,7.8-1.8l51.5-25.7l28.3,85c2.4,7.1,9,11.9,16.4,11.9h69.3c5.6,0,10.8-2.7,14.1-7.2 c3.3-4.5,4.1-10.3,2.4-15.6L658,632h62.6c6.7,0,12.8-3.8,15.7-9.9C739.2,616.1,738.3,608.9,734.1,603.7z',fill:'currentColor'}),t.MixDOM.def('path',{d:'M334.2,32H49.8C39.9,32,32,39.9,32,49.8v284.4c0,9.8,7.9,17.8,17.8,17.8h284.4c9.8,0,17.8-7.9,17.8-17.8V49.8 C352,39.9,344.1,32,334.2,32z M287.6,138.7L187.6,272c-4.1,5.4-10.4,8.8-17.2,8.9c-0.2,0-0.3,0-0.6,0c-6.6,0-12.8-2.9-17.1-8 l-55.6-66.7c-7.8-9.4-6.6-23.5,2.8-31.3c9.4-7.8,23.5-6.6,31.3,2.8l37.6,45.1L252,112c7.4-9.8,21.3-11.8,31.1-4.4 C292.9,114.9,294.9,128.9,287.6,138.7z',fill:'currentColor'}),t.MixDOM.def('path',{d:'M193.8,752c-26.3,0-45-22.5-45-45V566h-37.6c0-26.3,30-45,82.5-45c26.3,0,45,22.5,45,45v141h33.8 C276.2,733.2,238.8,752,193.8,752z',fill:'currentColor'}),t.MixDOM.def('circle',{cx:'193.8',cy:'439',r:'45',fill:'currentColor'})),'click-tip':t.MixDOM.def('svg',{viewBox:'0 0 768 768'},t.MixDOM.def('path',{d:'M178.5,560c-37.8,0-64.7-32.3-64.7-64.7V263.4h-54c0-37.8,43.1-64.7,118.6-64.7c37.8,0,64.7,32.3,64.7,64.7v231.9h48.6 C297.1,533,243.2,560,178.5,560z',fill:'currentColor'}),t.MixDOM.def('circle',{cx:'178.5',cy:'80.7',r:'64.7',fill:'currentColor'}),t.MixDOM.def('path',{d:'M734.1,603.7L508.8,326.4c-4.6-5.7-12.3-7.9-19.3-5.4c-6.9,2.5-11.5,9-11.5,16.3v312c0,6,3.1,11.6,8.2,14.7 c2.8,1.7,5.9,2.6,9.1,2.6c2.6,0,5.3-0.6,7.8-1.8l51.5-25.7l28.3,85c2.4,7.1,9,11.9,16.4,11.9h69.3c5.6,0,10.8-2.7,14.1-7.2 c3.3-4.5,4.1-10.3,2.4-15.6L658,632h62.6c6.7,0,12.8-3.8,15.7-9.9C739.2,616.1,738.3,608.9,734.1,603.7z',fill:'currentColor'})),filter:t.MixDOM.def('svg',{viewBox:'0 0 768 768'},t.MixDOM.def('path',{d:'M448 384v252.16c1.28 9.6-1.92 19.84-9.28 26.56-12.48 12.48-32.64 12.48-45.12 0l-64.32-64.32c-7.36-7.36-10.56-17.28-9.28-26.56v-187.84h-0.96l-184.32-236.16c-10.88-13.76-8.32-33.92 5.44-44.8 6.080-4.48 12.8-7.040 19.84-7.040h448c7.040 0 13.76 2.56 19.84 7.040 13.76 10.88 16.32 31.040 5.44 44.8l-184.32 236.16h-0.96z',fill:'currentColor'})),'filter-expanded':t.MixDOM.def('svg',{viewBox:'0 0 768 768'},t.MixDOM.def('path',{d:'M 672,512 L 544,672 L 416,512',fill:'none',stroke:'currentColor','stroke-width':'96','stroke-linejoin':'round','stroke-linecap':'round'}),t.MixDOM.def('path',{d:'M288.5,282.4v191.2c1,7.3-1.5,15-7,20.1c-9.5,9.5-24.7,9.5-34.2,0L198.5,445c-5.6-5.6-8-13.1-7-20.1V282.4h-0.7L51,103.3 c-8.2-10.4-6.3-25.7,4.1-34c4.6-3.4,9.7-5.3,15-5.3h339.7c5.3,0,10.4,1.9,15,5.3c10.4,8.2,12.4,23.5,4.1,34L289.3,282.4H288.5 L288.5,282.4z',fill:'currentColor'})),'filter-collapsed':t.MixDOM.def('svg',{viewBox:'0 0 768 768'},t.MixDOM.def('path',{d:'M 544,384 L 704,512 L 544,640',fill:'none',stroke:'currentColor','stroke-width':'96','stroke-linejoin':'round','stroke-linecap':'round'}),t.MixDOM.def('path',{d:'M288.5,282.4v191.2c1,7.3-1.5,15-7,20.1c-9.5,9.5-24.7,9.5-34.2,0L198.5,445c-5.6-5.6-8-13.1-7-20.1V282.4h-0.7L51,103.3 c-8.2-10.4-6.3-25.7,4.1-34c4.6-3.4,9.7-5.3,15-5.3h339.7c5.3,0,10.4,1.9,15,5.3c10.4,8.2,12.4,23.5,4.1,34L289.3,282.4H288.5 L288.5,282.4z',fill:'currentColor'})),'filter-parents':t.MixDOM.def('svg',{viewBox:'0 0 768 768'},t.MixDOM.def('path',{d:'M288.5,282.4v191.2c1,7.3-1.5,15-7,20.1c-9.5,9.5-24.7,9.5-34.2,0L198.5,445c-5.6-5.6-8-13.1-7-20.1V282.4h-0.7L51,103.3 c-8.2-10.4-6.3-25.7,4.1-34c4.6-3.4,9.7-5.3,15-5.3h339.7c5.3,0,10.4,1.9,15,5.3c10.4,8.2,12.4,23.5,4.1,34L289.3,282.4H288.5 L288.5,282.4z',fill:'currentColor'}),t.MixDOM.def('path',{d:'M656,576c-35.9,0-66.3,23.7-76.4,56.3c-1.2-0.2-2.4-0.3-3.6-0.3H472v-99.3c36.9-10.5,64-44.5,64-84.7c0-48.5-39.5-88-88-88 s-88,39.5-88,88c0,40.2,27.1,74.2,64,84.7V656c0,13.3,10.7,24,24,24h128c1.2,0,2.4-0.1,3.6-0.3c10.1,32.6,40.5,56.3,76.4,56.3 c44.2,0,80-35.8,80-80S700.2,576,656,576z M408,448c0-22.1,17.9-40,40-40s40,17.9,40,40s-17.9,40-40,40S408,470.1,408,448z',fill:'currentColor'})),'filter-children':t.MixDOM.def('svg',{viewBox:'0 0 768 768'},t.MixDOM.def('path',{d:'M288.5,282.4v191.2c1,7.3-1.5,15-7,20.1c-9.5,9.5-24.7,9.5-34.2,0L198.5,445c-5.6-5.6-8-13.1-7-20.1V282.4h-0.7L51,103.3 c-8.2-10.4-6.3-25.7,4.1-34c4.6-3.4,9.7-5.3,15-5.3h339.7c5.3,0,10.4,1.9,15,5.3c10.4,8.2,12.4,23.5,4.1,34L289.3,282.4H288.5 L288.5,282.4z',fill:'currentColor'}),t.MixDOM.def('path',{d:'M656,560c-44.7,0-82.3,30.6-93,72h-91V524.3c32.5-10.2,56-40.5,56-76.3c0-44.2-35.8-80-80-80s-80,35.8-80,80 c0,35.8,23.5,66.1,56,76.3V656c0,13.3,10.7,24,24,24h115c10.7,41.4,48.3,72,93,72c52.9,0,96-43.1,96-96S708.9,560,656,560z M656,699.6c-24.1,0-43.6-19.6-43.6-43.6s19.6-43.6,43.6-43.6s43.6,19.6,43.6,43.6S680.1,699.6,656,699.6z',fill:'currentColor'})),'item-selected':t.MixDOM.def('svg',{viewBox:'0 0 10 10'},t.MixDOM.def('circle',{r:2,cx:5,cy:5,fill:'currentColor'})),'item-deselected':t.MixDOM.def('svg',{viewBox:'0 0 10 10'},t.MixDOM.def('circle',{r:1.6,cx:5,cy:5,strokeWidth:.8,stroke:'currentColor',fill:'none'}))};function getItemTypeFrom(e){switch(e.type){case'':return'empty';case'dom':return e.def.domContent&&e.def.domContent.nodeType?'dom-external':void 0!==e.def.domElement?'dom-pseudo':e.def.tag?'dom-element':'dom-text';case'boundary':return'component';default:return e.type}}function getPassPhraseAndSource(e){return e.def.getRemote?['Remote pass',e.def.getRemote().boundary]:['Content pass',e.boundary&&e.boundary.sourceBoundary]}function consoleLog(e,...t){console.log(...t),e&&e.console&&e.console!==console&&e.console.log(...t)}var r;!function(e){e[e.Left=1]='Left',e[e.Top=2]='Top',e[e.Right=4]='Right',e[e.Bottom=8]='Bottom',e[e.Horizontal=5]='Horizontal',e[e.Vertical=10]='Vertical',e[e.None=0]='None',e[e.All=15]='All'}(r||(r={}));const cleanMargin=e=>{const t={top:0,left:0,right:0,bottom:0};if('number'==typeof e)t.top=t.left=t.bottom=t.right=e;else if(e&&e.constructor===Array)t.left=t.right=e[0]||0,t.top=t.bottom=e[1]||0;else if(e){const o=e;t.left=o.left||0,t.right=o.right||0,t.top=o.top||0,t.bottom=o.bottom||0}return t};class FitBoxAlgoritms{static fitToSize(e,t,o=r.None,i='push',n='push'){const s=Object.assign({},e);if((o&r.Horizontal)!==r.Horizontal){let e=s.left,n=s.width;'anchored'===i?[e,n]=FitBoxAlgoritms.axisFitAnchored(s.left,s.width,t.left,t.width,!(o&r.Left),!(o&r.Right)):'push'===i&&([e,n]=FitBoxAlgoritms.axisFitPush(s.left,s.width,t.left,t.width)),s.left=e,s.width=n}if((o&r.Vertical)!==r.Vertical){let e=s.top,i=s.height;'anchored'===n?[e,i]=FitBoxAlgoritms.axisFitAnchored(s.top,s.height,t.top,t.height,!(o&r.Top),!(o&r.Bottom)):'push'===n&&([e,i]=FitBoxAlgoritms.axisFitPush(s.top,s.height,t.top,t.height)),s.top=e,s.height=i}return s}static axisFitPush(e,t,o,i){t>i&&(t=i);const n=e+t,s=o+i;return n>s&&(e-=n-s),e<o&&(e=o),[e,t]}static axisFitAnchored(e,t,o,i,n=!0,s=!0){const l=o+i;let r=e,a=e+t,d=0;if(s&&a>l){d=l-a,a=l}if(n&&r+d<o){d=o-(r+d),r=o}return d>0&&s&&a+d>l&&(a=l,d=0),[r,a-r]}}const a=t.MixDOM.component((e=>{let o=null;const n=new t.Ref;e.state={left:0,top:0,width:0,height:0},e.listenTo('didMount',(()=>{o=new ResizeObserver(onResize);const e=n.getElement();if(e){const t=e.parentElement;o.observe(e),t&&o.observe(t)}})),e.listenTo('willUnmount',(()=>{o&&o.disconnect(),o=null}));const onResize=()=>{const t=n.getElement(),o={top:e.props.offset&&e.props.offset.top||0,left:e.props.offset&&e.props.offset.left||0,width:t?t.offsetWidth:0,height:t?t.offsetHeight:0},i=e.props.align&&e.props.align.horizontal||'left',s=e.props.align&&e.props.align.vertical||'top';'right'===i?o.left-=o.width:'center'===i&&(o.left-=.5*o.width),'bottom'===s?o.top-=o.height:'center'===s&&(o.top-=.5*o.height),resizeBy(o)},resizeBy=t=>{let o={left:0,top:0,width:0,height:0};if(e.props.getContainerRect)o=e.props.getContainerRect();else{const e=n.getElement();if(e){const t=e.parentElement;t&&(o.width=t.offsetWidth,o.height=t.offsetHeight)}}const i=cleanMargin(e.props.margin);o.left=i.left,o.width-=i.left+i.right,o.top=i.top,o.height-=i.top+i.bottom;let s=0;const l=e.props.align?e.props.align.horizontal:'left',a=e.props.align?e.props.align.vertical:'top';e.props.lockHorizontal&&(s|='left'===l?r.Left:'right'===l?r.Right:r.Horizontal),e.props.lockVertical&&(s|='top'===a?r.Top:'bottom'===a?r.Bottom:r.Vertical);const d=e.props.lockHorizontal?'anchored':'push',c=e.props.lockVertical?'anchored':'push',p=FitBoxAlgoritms.fitToSize(t,o,s,d,c);e.props.lockHorizontal?p.width='left'===l?o.left+o.width-t.left:'right'===l?t.left+t.width-o.left:p.width:p.width=o.width,e.props.lockVertical?p.height='top'===a?o.top+o.height-t.top:'bottom'===a?t.top+t.height-o.top:p.height:p.height=o.height,!e.props.onMaxSize||p.width===e.state.width&&p.height===e.state.height||e.props.onMaxSize(p.width,p.height),e.isMounted()?e.setState(p,!0,!1,null,null):e.setState(p)};return onResize(),(e,o)=>{const s=Object.assign(Object.assign({},e.style?'string'==typeof e.style?i.parseDOMStyle(e.style):e.style:void 0),{position:'absolute',left:o.left+'px',top:o.top+'px',maxWidth:o.width+'px',maxHeight:o.height+'px'});return t.MixDOM.def('div',{className:i.classNames('m-size-fitter',e.className),_ref:n,style:s},t.MixDOM.Content)}})),d=t.MixDOM.component((e=>{e.state={refreshId:{}};const o={top:0,left:0},s={horizontal:e.props.hAlign||'center',vertical:e.props.vAlign||'center'},l=n.createMemo(((e,t)=>()=>e&&e()||{top:0,left:0,width:window.innerWidth,height:window.innerHeight})),r=n.createTrigger((({getContainerRect:e,getElement:t,elementMargin:i,hAlign:n,vAlign:r,refreshId:a})=>{const d=l(e,a)(),c=t&&('function'==typeof t?t():t)||null;if(c&&document.body.contains(c)){const e=c.getBoundingClientRect(),t=cleanMargin(null==i?0:i);s.horizontal=n||'center',s.vertical=r||(e.top+.5*e.height>.5*d.height?'bottom':'top'),o.left=e.left+('right'===s.horizontal?-t.right+e.width:'center'===s.horizontal?.5*e.width:t.left),o.top=e.top+('top'===s.vertical?t.bottom+e.height:'center'===s.vertical?.5*e.height:-t.top)}else o.left=d.left+.5*d.width,o.top=d.top+.5*d.height,s.horizontal='center',s.vertical='center'})),d=new ResizeObserver((()=>{e.setState({refreshId:{}})}));e.listenTo('willUnmount',(()=>d.disconnect));const domDidMount=e=>{d.observe(e)};return(e,n)=>(r({getContainerRect:e.getContainerRect,getElement:e.getElement,elementMargin:e.elementMargin,hAlign:e.hAlign,vAlign:e.vAlign,refreshId:n.refreshId}),t.MixDOM.def('div',{class:i.classNames('ui-popup-contents layout-abs-fill',e.className),style:e.style,_signals:{domDidMount}},t.MixDOM.def(a,{offset:o,getContainerRect:l(e.getContainerRect),align:s,margin:e.margin},t.MixDOM.def('div',{class:i.classNames('popup-content',e.contentClassName),style:e.contentStyle},t.MixDOM.Content))))})),UIPopupContainer=e=>{const o=t.MixDOM.def(d,{getElement:e.sourceElement,contentClassName:e.contentClassName,contentStyle:e.contentStyle,hAlign:e.horizontalAlign,vAlign:e.verticalAlign,margin:e.containerMargin,elementMargin:e.elementMargin,style:e.style},t.MixDOM.Content);return!e.container||e.container instanceof Node?t.MixDOM.def(t.MixDOM.Portal,{container:e.container||document.body},o):t.MixDOM.def(e.container,null,o)},UIVirtualRow=e=>t.MixDOM.def('div',{className:'ui-virtual-row',style:{position:'absolute',top:e.rowHeight*e.iRow+'px',height:e.rowHeight,width:'100%'}},t.MixDOM.Content),c=t.MixDOM.component((o=>{o.state={height:0,iStart:-1,iEnd:-1};const s=new t.Ref;let l;o.scrollToIndex=(t,i,n,r)=>{const a=s.getElement();if(!a)return;r&&(l=i=>{const finishOff=()=>r(o.getElementAt(t));i?o.listenTo('didUpdate',finishOff,null,e.SignalListenerFlags.OneShot):finishOff()});const d=a.scrollTop,c=t*o.props.rowHeight;(!n||c<d||c+o.props.rowHeight>d+a.clientHeight)&&a.scrollTo({top:c,behavior:i||'auto'}),d===a.scrollTop&&l&&(l(!1),l=void 0)},o.getRootElement=()=>s.getElement(),o.getListElement=()=>{var e;return(null===(e=s.getElement())||void 0===e?void 0:e.querySelector('.list-content'))||null},o.getElementAt=e=>{var t;return(null===(t=s.getElement())||void 0===t?void 0:t.querySelectorAll('.list-content .ui-virtual-row')[e-o.getRenderedState().iStart])||null},o.getFirstVisibleItem=e=>{const t=s.getElement(),o=t&&t.querySelectorAll('.list-content .ui-virtual-row');if(!o)return null;const i=t.scrollTop;return e?o[0]||null:[...o].find((e=>e.offsetTop>=i))||null};const r=n.createDataTrigger((()=>{let e=null;const mountResizer=t=>{e=new ResizeObserver(onRefresh),e.observe(t),o.setState({height:t.offsetHeight}),onRefresh()};s.listenTo('domDidMount',mountResizer);const unmountResizer=()=>{s.unlistenTo('domDidMount',mountResizer),s.unlistenTo('domWillUnmount',unmountResizer),e&&e.disconnect(),e=null};return s.listenTo('domWillUnmount',unmountResizer),unmountResizer})),onRefresh=()=>{const e=s.getElement(),t=(null==e?void 0:e.scrollTop)||0,i=void 0!==o.props.rowTolerance?o.props.rowTolerance:2,r=(null==e?void 0:e.offsetHeight)||0,a=o.props.nRows-1,d={iStart:Math.min(Math.max(0,Math.floor(t/o.props.rowHeight-i)),a),iEnd:Math.min(Math.floor((t+r)/o.props.rowHeight+i),a),height:r},c=!n.areEqual(d,o.state,1);l&&(l(c),l=void 0),c&&o.setState(d)},a=n.createDataTrigger(onRefresh,[o.props.rowHeight,o.props.nRows,o.props.rowTolerance,o.props.refreshId]),d=onRefresh;return(e,o)=>{r(!1!==e.handleResizing),a([e.rowHeight,e.nRows,e.rowTolerance,e.refreshId]);const l=e.nRows,c=n.numberRange(o.iStart,o.iEnd+1).map((o=>{let i=e.renderRow(o,l,e.rowHeight);return i&&!1!==e.autoWrap?t.MixDOM.def(UIVirtualRow,{iRow:o,nRows:l,rowHeight:e.rowHeight,_key:e.getRowKey?e.getRowKey(o,l):o},i):i}));return t.MixDOM.def('div',{_ref:s,className:i.classNames('ui-virtual-list layout-scrollable style-scrollable layout-fit-height',e.className),style:Object.assign({display:'flex',flexDirection:'column'},e.style||{}),onScroll:d},t.MixDOM.def('div',{className:i.classNames('list-content',e.contentClassName),style:Object.assign({position:'relative',paddingBottom:l*e.rowHeight+'px'},e.contentStyle||{})},c))}}));function UIList(e,o){const s=n.createMemo(((...e)=>({}))),l=n.createMemo(((e,t,...o)=>{let i=0;return t?e.filter(((e,o)=>!!t(e,o,i)&&++i)):e.slice()}));let r=l(o.props.items,o.props.filter,o.props.refreshId);const renderRow=(e,i,n)=>{const s=o.props,l=r[e];return l?t.MixDOM.def(s.Item,Object.assign({_key:s.keyProp?l[s.keyProp]:l,item:l},s.commonProps)):null},getRowKey=e=>o.props.keyProp&&o.props.items[e]?o.props.items[e][o.props.keyProp]:e;return(e,o)=>{var n;return r=l(e.items,e.filter,e.refreshId),t.MixDOM.def('div',{class:i.classNames('ui-tree-list flex-col layout-fit-size',e.className),role:'tree'},t.MixDOM.def(c,{_ref:e.refVirtualList,nRows:r.length,getRowKey,rowHeight:null!==(n=e.rowHeight)&&void 0!==n?n:30,renderRow,refreshId:s(r,e.commonProps,e.refreshId),className:e.listClassName}))}}var __rest$6=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&'function'==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const MixPositionedPopup=(e,o)=>(o.state=Object.assign(Object.assign({},o.state),{popupOpened:!1,popupSourceElement:null}),o.showPopup=(e,t)=>{void 0!==e&&o.setInState('popupSourceElement',e);const i=o.state.popupFadeIn;t||!i?o.setInState('popupOpened',!0):!0!==o.state.popupOpened&&(o.setTimer('popupFade',(()=>{'start'===o.state.popupOpened&&(o.setTimer('popupFade',(()=>'in'===o.state.popupOpened&&o.setInState('popupOpened',!0)),i),o.setInState('popupOpened','in'))}),25),o.setInState('popupOpened','start'))},o.hidePopup=e=>{o.state.popupOpened&&(e||!o.state.popupFadeOut?o.setState({popupOpened:!1,popupSourceElement:null}):(o.setInState('popupOpened','out'),o.setTimer('popupFade',(()=>'out'===o.state.popupOpened&&o.setState({popupOpened:!1,popupSourceElement:null})),o.state.popupFadeOut)))},o.WithTooltip=t.MixDOM.wired((()=>({popupOpened:o.state.popupOpened,horizontalAlign:o.state.horizontalAlign,verticalAlign:o.state.verticalAlign,containerMargin:o.state.containerMargin,elementMargin:o.state.elementMargin,popupFadeIn:o.state.popupFadeIn,popupFadeOut:o.state.popupFadeOut,popupSourceEl:o.state.popupSourceElement,refreshId:o.refreshPopupId})),(e=>{if(!e.popupOpened)return null;const n=o.renderPopup?o.renderPopup():null;if(null==n)return null;const{popupOpened:s,refreshId:l}=e,r=__rest$6(e,['popupOpened','refreshId']),a='start'===s||'in'===s?e.popupFadeIn:e.popupFadeOut;return t.MixDOM.def(UIPopupContainer,Object.assign({container:o.popupContainer,sourceElement:e.popupSourceEl,contentClassName:i.classNames('style-shadow-overlay','out'===s||'start'===s?'style-opacity-0':'style-opacity-1'),contentStyle:a?`transition: opacity ${a}ms ${'out'===s?'ease-in':'ease-in-out'}`:void 0},r),n)}),'WithTooltip'),o.addWired(o.WithTooltip),null);var __rest$5=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&'function'==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const p=t.MixDOM.remote(),u=t.MixDOM.mixFuncsWith(((e,o)=>{o.hoverTimeout=500;let i=!1;return o.hoverRef=new t.Ref,o.hoverRef.listenTo('domDidMount',(e=>{e.addEventListener('mouseenter',(()=>{!o.hoverDisabled&&o.setTimer('onMouseEnter',(()=>o.sendSignal('onHover',i=!0)),o.hoverTimeout)})),e.addEventListener('mouseleave',(()=>{'one-time'===o.hoverDisabled&&(o.hoverDisabled=!1),o.clearTimers('onMouseEnter'),i&&o.sendSignal('onHover',i=!1)}))})),null}),((e,t)=>{const onKeyDown=e=>{'Escape'===e.key&&(e.preventDefault(),e.stopPropagation(),t.sendSignal('onEscape'))};return t.useEscape=e=>(e?window.addEventListener:window.removeEventListener)('keydown',onKeyDown),null}),MixPositionedPopup,((e,o)=>{o.state=Object.assign(Object.assign({},o.state),{elementMargin:5,containerMargin:10,popupFadeIn:100,popupFadeOut:300}),o.popupContainer=p,o.setHovered=e=>{const t=o.hoverRef.getElement();e?o.showPopup(o.props.getPositionSource?o.props.getPositionSource(t):t):o.hidePopup(),o.useEscape(o.props.escToCloseTip&&e||!1)},o.listenTo('onHover',(e=>{e&&'one-time'===o.hoverDisabled?o.hoverDisabled=!1:o.setHovered(e)})),o.listenTo('onEscape',(()=>o.hidePopup()));const onClick=e=>{o.props.onClick&&o.props.onClick(e),!1!==o.props.clickToCloseTip&&(o.state.popupOpened?o.hidePopup():o.hoverDisabled='one-time')};return o.renderPopup=()=>'function'==typeof o.props.renderTip?o.props.renderTip(o):o.props.renderTip,o.listenTo('preUpdate',(e=>{e&&e.disableHover!==o.props.disableHover&&(o.hoverDisabled=o.props.disableHover)})),e=>{const{class:n,className:s,tag:l,renderTip:r,getPositionSource:a,escToCloseTip:d,clickToCloseTip:c,onClick:p,refreshId:u,rootRef:f}=e,M=__rest$5(e,['class','className','tag','renderTip','getPositionSource','escToCloseTip','clickToCloseTip','onClick','refreshId','rootRef']);return o.refreshPopupId=r,t.MixDOM.def(l,Object.assign({_ref:f?[f,o.hoverRef]:o.hoverRef,class:i.classNames(n,s),onClick},M),t.MixDOM.Content,t.MixDOM.def(o.WithTooltip))}}),null,'UIAppTip'),wrapTip=(...e)=>t.MixDOM.def('div',{class:i.classNames('style-ui-panel flex-col layout-gap-l'),style:'min-width: 100px;'},...e);var __rest$4=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&'function'==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};function UIAppIcon(e){const{iconName:o,iconSize:n,className:s}=e,r=__rest$4(e,['iconName','iconSize','className']);return t.MixDOM.def('span',Object.assign({},r,{className:i.classNames('ui-icon style-ui-icon flex-no-shrink',n&&'size-'+n,s)}),l[o])}var __rest$3=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&'function'==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const UIAppButton=(e,o)=>{const onClick=e=>{o.props.onPress&&o.props.onPress(e),o.props.onClick&&o.props.onClick(e)},onKeyDown=e=>{!o.props.onPress||' '!==e.key&&'Enter'!==e.key||o.props.disabled||(e.preventDefault(),o.props.onPress(e)),o.props.onKeyDown&&o.props.onKeyDown(e)};return e=>{const{look:o,size:n,invisible:s,iconName:l,iconClassName:r,className:a,disabled:d,onPress:c,onClick:p,onKeyDown:f,toggled:M}=e,g=__rest$3(e,['look','size','invisible','iconName','iconClassName','className','disabled','onPress','onClick','onKeyDown','toggled']);return t.MixDOM.def(u,Object.assign({},g,{tag:'button',disabled:!!s||d,onKeyDown,onClick,className:i.classNames('ui-app-button style-ui-button style-ui-focusable','focusable-look-'+(o||'edge'),void 0!==M?M?'button-on':'button-off':void 0,n&&'size-'+n,s&&'layout-no-pointer style-opacity-0',a)}),void 0!==l?t.MixDOM.def(UIAppIcon,{iconName:l,className:r,iconSize:'narrow'!==n&&'no'!==n?n:void 0}):null,t.MixDOM.Content)}};var __rest$2=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&'function'==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const UIAppInput=(e,o)=>{const n=new t.MixDOM.Ref,onInput=e=>{if(o.props.onInput&&o.props.onInput(e),o.props.onValue){const e=n.getElement();e&&o.props.onValue(e.value)}},onKeyDown=e=>{if(o.props.onKeyDown&&o.props.onKeyDown(e),'Escape'===e.key&&o.props.escToClearInput){const e=n.getElement();e&&e.value&&(e.value='',o.props.onValue&&o.props.onValue(''))}};return e=>{const{look:o,escToClearInput:s,className:l,onKeyDown:r,rootRef:a,onInput:d}=e,c=__rest$2(e,['look','escToClearInput','className','onKeyDown','rootRef','onInput']);return t.MixDOM.def(u,Object.assign({},c,{rootRef:n,onKeyDown,onInput,tag:'input',className:i.classNames('ui-app-input style-ui-input style-ui-focusable','focusable-look-'+(o||'edge'),l)}))}};function stringifyObject(e,t,o=1){if(!e||'object'!=typeof e)return'string'==typeof e?'"'+e+'"':''+e;if(Array.isArray(e))return'['+(o?e.map((e=>stringifyObject(e,!1,o-1))):e.toString())+']';let i='';if(!o)return''+e;o--;for(const n in e)i+=(t?'\n    ':' ')+n+': '+(o?stringifyObject(e[n],!1,o):'string'==typeof e[n]?'"'+e[n]+'"':''+e[n])+',';return i&&(i=i.slice(0,i.length-1)),'{'+i+(t&&i?'\n':' ')+'}'}const Prettify=e=>{const o=i.classNames('style-ui-code prettyprint',e.className);return window.PR?t.MixDOM.defHTML(window.PR.prettyPrintOne(e.code),e.tag||'code',{className:o,style:e.style}):t.MixDOM.def(e.tag||'code',{class:o,style:e.style},e.code)},PrettifyDelay=(e,o)=>{o.state={};const s=n.createTrigger((()=>{o.state.isReady&&o.setState({isReady:!1}),o.setTimer('reset',(()=>o.setState({isReady:!0})),o.props.delay||100)}),void 0,'shallow');return(e,o)=>{const n=e.origCode.trim();s([e.resetId,n]);const l=i.classNames('style-ui-code prettyprint',e.className),r=e.prePrettifier?e.prePrettifier(n):n;return o.isReady&&window.PR?t.MixDOM.defHTML(window.PR.prettyPrintOne(r),e.tag||'code',{className:l,style:e.style}):t.MixDOM.def(e.tag||'code',{class:l,style:e.style},n)}};function escapeHTML(e){return window.PR?e.replace(/\&(?!(\w+;))/g,'&amp;').replace(/</g,'&lt;'):e}function beautify(e){return window.exports&&window.exports.js_beautify?window.exports.js_beautify(e):e}function getMiniScrollableProps(e){return{className:'layout-scrollable style-scrollable'+(e?' '+e:''),style:'max-width: 100%; max-height: 250px'}}const renderComponentLinkTip=()=>wrapTip(t.MixDOM.def('div',null,'Scroll and focus to the target.',t.MixDOM.def('br',null),' - If is matching and item is out of view, also selects it.',t.MixDOM.def('br',null),' - Click with ',t.MixDOM.def('b',null,'Ctrl'),'/',t.MixDOM.def('b',null,'Alt'),' to open details popup instead.',t.MixDOM.def('br',null),' - Click with ',t.MixDOM.def('b',null,'Shift'),' to log into console instead.')),renderUIAppTipSectionTip=()=>wrapTip(t.MixDOM.def('div',null,'Toggle the section visibility.',t.MixDOM.def('br',null),' - Click with ',t.MixDOM.def('b',null,'Ctrl'),'/',t.MixDOM.def('b',null,'Alt'),' to only show this section or all.')),renderConsoleTip=()=>wrapTip(t.MixDOM.def('div',null,'Click to log in console.')),f=['heading','code','props','state','contexts','settings','rendered-by','wired','remote','children','renders'],UIAppTipSection=(e,o,n)=>{o.state={hiddenSections:[]},n.listenToData('state.hiddenTipSections',(e=>{o.setState({hiddenSections:e})}),[o.state.hiddenSections]);const onSectionClick=e=>{let t=o.state.hiddenSections.slice();const i=o.props.type;if(e.ctrlKey||e.altKey||e.metaKey)t=t.length+1!==f.length||t.includes(i)?f.filter((e=>e!==i)):[];else{const e=t.indexOf(i);-1!==e?t.splice(e,1):t.push(i)}n.setInData('state.hiddenTipSections',t)},onPressLink=e=>{o.props.onItemLink&&void 0!==o.props.idToScroll&&o.props.onItemLink(o.props.idToScroll,e.shiftKey?'log':e.ctrlKey||e.altKey||e.metaKey?'details':'focus')},onLog=()=>{consoleLog(o.props.debugInfo,'MixDOMDebug: Log info',Object.assign({},o.props.debugTarget))};return(e,o)=>{const n=!o.hiddenSections.includes(e.type),s=void 0===e.useOverflow?void 0!==e.extraTitle||void 0!==e.afterTitle:e.useOverflow;return t.MixDOM.def('aside',null,t.MixDOM.def('h3',{class:i.classNames('style-ui-heading',e.debugInfo&&'flex-row')},t.MixDOM.def(UIAppButton,{look:'transparent',className:i.classNames(s&&'style-text-ellipsis',!n&&'style-dimmed'),renderTip:renderUIAppTipSectionTip,onPress:onSectionClick},t.MixDOM.def(Title,{title:e.title,extraTitle:e.extraTitle,afterTitle:e.afterTitle,idToScroll:e.idToScroll,onPress:onPressLink})),e.debugInfo?t.MixDOM.def('span',{class:'flex-grow'}):null,e.debugInfo?t.MixDOM.def(UIAppButton,{look:'transparent',iconName:'console',onPress:onLog,renderTip:renderConsoleTip}):null),n?t.MixDOM.def(t.MixDOM.WithContent,null,t.MixDOM.def('div',Object.assign({},!1!==e.useDefaultLimits?getMiniScrollableProps('style-ui-mini-panel'):{className:'style-ui-mini-panel'}),t.MixDOM.Content)):null)}},UIAppTipHeading=(e,o,n)=>{const onPressLink=e=>{o.props.onItemLink&&void 0!==o.props.idToScroll&&o.props.onItemLink(o.props.idToScroll,e.shiftKey?'log':e.ctrlKey||e.altKey||e.metaKey?'details':'focus')},onPressTargetLog=e=>{consoleLog(o.props.debugInfo,'MixDOMDebug: Log element',o.props.afterLogTarget)},onPressClose=e=>{o.props.onItemLink&&o.props.onItemLink(null,'details-break')},onHistoryPrev=e=>{o.props.onHistory&&o.props.onHistory(o.props.iHistory?Math.max(o.props.iHistory-1,0):0)},onHistoryNext=e=>{var t;o.props.onHistory&&o.props.onHistory(null!=o.props.iHistory?Math.min(o.props.iHistory+1,(null===(t=o.props.history)||void 0===t?void 0:t.length)||0):0)};return e=>{const o=void 0===e.useOverflow?void 0!==e.extraTitle||void 0!==e.afterTitle:e.useOverflow;return t.MixDOM.def('aside',{class:'layout-gap-m flex-col layout-padding-m-x layout-padding-l-y layout-padding-no-top'},t.MixDOM.def('h2',{class:'style-ui-heading flex-row flex-align-items-baseline layout-gap-m'},e.history&&e.history[1]?e.history[2]?t.MixDOM.def(t.MixDOM.Fragment,null,t.MixDOM.def(UIAppButton,{iconName:'back',look:'transparent',size:'large',className:'flex-align-self-center history-button',onPress:onHistoryPrev,disabled:0===e.iHistory}),t.MixDOM.def(UIAppButton,{iconName:'forwards',look:'transparent',size:'large',className:'flex-align-self-center history-button',onPress:onHistoryNext,disabled:e.iHistory===e.history.length-1})):t.MixDOM.def(UIAppButton,{iconName:1===e.iHistory?'back':'forwards',look:'transparent',size:'large',className:'flex-align-self-center history-button',onPress:1===e.iHistory?onHistoryPrev:onHistoryNext}):null,t.MixDOM.def('span',{class:'flex-grow'}),t.MixDOM.def('span',{class:i.classNames('flex-row layout-gap-l',null!=e.extraTitle?'flex-align-items-center':'flex-align-items-baseline',o&&'style-text-ellipsis')},t.MixDOM.def(Title,{title:e.title,extraTitle:e.extraTitle,afterTitle:e.afterTitle,afterLogTitle:e.afterLogTitle,idToScroll:e.idToScroll,onPress:onPressLink,onPressAfterLog:onPressTargetLog})),t.MixDOM.def('span',{class:'flex-grow'}),t.MixDOM.def(UIAppButton,{iconName:'close',look:'transparent',size:'large',className:'flex-align-self-center',onPress:onPressClose})),t.MixDOM.def(t.MixDOM.WithContent,null,t.MixDOM.def('div',Object.assign({},!1!==e.useDefaultLimits?getMiniScrollableProps('style-ui-mini-panel layout-margin-no-bottom'):{className:'style-ui-mini-panel layout-margin-no-bottom'}),t.MixDOM.Content)))}};function Title(e){const o=null==e.afterLogTitle?null:t.MixDOM.def(UIAppButton,{look:'edge',size:'no',className:'style-text-ellipsis',onPress:e.onPressAfterLog,renderTip:renderConsoleTip},e.afterLogTitle);return e.idToScroll?t.MixDOM.def(t.MixDOM.Fragment,null,void 0!==e.extraTitle?t.MixDOM.def('span',null,e.title,': '):null,t.MixDOM.def(UIAppButton,{look:'edge',size:'no',className:'style-text-ellipsis',onPress:e.onPress,renderTip:renderComponentLinkTip},void 0!==e.extraTitle?e.extraTitle:e.title),e.afterTitle,o):t.MixDOM.def(t.MixDOM.Fragment,null,e.title,e.extraTitle,e.afterTitle,o)}function getGroundingTreeNode(e){let t=e;for(;t=t.parent;)switch(t.type){case'root':break;case'pass':case'boundary':return t}return null}function readComponentOneLine(e,o,i){if('boundary'===e.type)return t.MixDOM.def(t.MixDOM.Fragment,null,t.MixDOM.def(ComponentLink,{name:e.def.tag.name||'Anonymous',onPress:o||void 0}),t.MixDOM.def(Prettify,{code:e.def.tag.toString(),className:'style-text-ellipsis'}));const[n,s]=getPassPhraseAndSource(e),l=s&&s._outerDef.tag.name||'Anonymous';return t.MixDOM.def(t.MixDOM.Fragment,null,i?null:t.MixDOM.def('span',{_key:'pass',class:'style-color-dim'},o?t.MixDOM.def(ComponentLink,{name:n,onPress:o}):n),t.MixDOM.def('span',{_key:'from',class:'style-color-dim'},' from '),t.MixDOM.def('b',null,l))}function ComponentLink(e){return e.onPress?t.MixDOM.def(UIAppButton,{look:'edge',size:'narrow',className:e.className,onPress:e.onPress,renderTip:renderComponentLinkTip},t.MixDOM.def('b',null,e.name)):t.MixDOM.def('b',null,e.name)}function RenderComponentPartList(e){var o;const i='contexts'===e.part,n=i?(null===(o=e.component.contextAPI)||void 0===o?void 0:o.getContexts())||{}:e.component[e.part]||{};return t.MixDOM.def(RenderPartList,{portion:n,overrideText:i?'Context':void 0})}function RenderPartList(e){const o=e.keys||Object.keys(e.portion);return void 0===o[0]?null:t.MixDOM.def('ul',{class:'style-ui-list'},o.map((o=>t.MixDOM.def('li',{_key:o,class:'flex-row flex-align-items-baseline layout-gap-l'},t.MixDOM.def(RenderPropertyName,{bold:!0},o,': '),t.MixDOM.def(Prettify,{code:e.overrideText||beautify(stringifyObject(e.portion[o],!1,2)),tag:'pre',className:'style-text-ellipsis'})))))}function RenderPropertyName(e){return t.MixDOM.def('span',{class:i.classNames('style-color-dim layout-inline-block flex-no-shrink',e.italic&&'style-text-italic',e.bold&&'style-text-bold'),style:'min-width: 100px;'},t.MixDOM.Content)}function RenderComponentWiredChildren(e){if(!e.wired.size)return null;let o=-1;return t.MixDOM.def('ul',{class:'style-ui-list'},[...e.wired].map((i=>i.api&&i.api.components.size?[...i.api.components].map((i=>t.MixDOM.def('li',{_key:++o,class:'flex-row flex-align-items-baseline layout-gap-l'},t.MixDOM.def(RenderComponentChild,{treeNode:i.boundary.treeNode,onItemLink:e.onItemLink,index:o,childText:'Wired'})))):null)))}function RenderComponentRemoteChildren(e){const o=e.remote,i=e.remotePasses||o.getHost().findTreeNodes(['pass'],0,!0,(e=>e.def.getRemote&&e.def.getRemote()===o));return i[0]?t.MixDOM.def('ul',{class:'style-ui-list'},[...i].map(((o,i)=>t.MixDOM.def('li',{_key:o,class:'flex-row flex-align-items-baseline layout-gap-l'},t.MixDOM.def(RenderComponentChild,{treeNode:o,onItemLink:e.onItemLink,index:i,childText:'Pass'}))))):null}function RenderComponentChildren(e){const o=e.treeNode.boundary;return o&&o.innerBoundaries[0]?t.MixDOM.def('ul',{class:'style-ui-list'},o.innerBoundaries.map(((o,i)=>t.MixDOM.def('li',{_key:i,class:'flex-row flex-align-items-baseline layout-gap-l'},t.MixDOM.def(RenderComponentChild,{treeNode:o.treeNode,onItemLink:e.onItemLink,index:i}))))):null}const RenderComponentChild=(e,o)=>{const onPress=e=>o.props.onItemLink&&o.props.onItemLink(o.props.treeNode,e.shiftKey?'log':e.ctrlKey||e.altKey||e.metaKey?'details':'focus');return e=>t.MixDOM.def(t.MixDOM.Fragment,null,t.MixDOM.def(RenderPropertyName,{italic:!0},e.childText||'Child',' ',void 0===e.index?'':'#'+(e.index+1),': '),readComponentOneLine(e.treeNode,onPress))},RenderedByComponents=(e,o)=>{var i,s,l;o.setConstantProps({treeNode:!0});const r=o.props.treeNode,a=(null===(i=r.sourceBoundary)||void 0===i?void 0:i.treeNode)||null,d='pass'===r.type?r:null,c=d?d.def.getRemote?d.def.getRemote().boundary.treeNode:(null===(l=null===(s=d.def.contentPass)||void 0===s?void 0:s.sourceBoundary)||void 0===l?void 0:l.treeNode)||null:null;let p=[];const u=new Map,f=n.createTrigger((()=>{if(p=[],a){let e=getGroundingTreeNode(r);for(;e&&e!==a&&(p.push(e),!e.def.getRemote||e.def.getRemote().boundary.treeNode!==a);)e=getGroundingTreeNode(e);p.reverse()}const e=new Set(u.keys());for(const t of[...[a,c].filter((e=>e)),...p])t&&(u.set(t,u.get(t)||(e=>{o.props.onItemLink&&o.props.onItemLink(t,e.shiftKey?'log':e.ctrlKey||e.altKey||e.metaKey?'details':'focus')})),e.delete(t));for(const t of e)u.delete(t)})),M={class:'flex-row flex-align-items-baseline layout-gap-l'};return e=>(f(e.iUpdate),a||p[0]?t.MixDOM.def(UIAppTipSection,{type:'rendered-by',title:'Rendered by component'},t.MixDOM.def('ul',{class:'style-ui-list'},c?t.MixDOM.def('li',Object.assign({},M,{_key:'pass'}),t.MixDOM.def(RenderPropertyName,{italic:!0},'Pass from: '),readComponentOneLine(c,u.get(c))):null,a?t.MixDOM.def('li',Object.assign({},M,{_key:'source'}),t.MixDOM.def(RenderPropertyName,{italic:!0},'Source: '),readComponentOneLine(a,u.get(a))):null,p.map((e=>t.MixDOM.def('li',Object.assign({},M,{_key:e.boundary.bId}),t.MixDOM.def(RenderPropertyName,{italic:!0},'Through: '),readComponentOneLine(e,u.get(e))))))):null)},UIAppTipDisplay=(e,o)=>{o.state={history:[o.props.item],iHistory:0,isAlive:!1};const bringAlive=()=>!o.hasTimer('alive')&&o.setTimer('alive',(()=>o.setState({isAlive:!0})),25),onKeyDown=e=>{'Escape'===e.key&&o.props.escToCloseTip&&o.props.onItemLink&&o.props.onItemLink(null,'details-break')};o.listenTo('didMount',(()=>{bringAlive(),document.addEventListener('keydown',onKeyDown)})),o.listenTo('willUnmount',(()=>document.removeEventListener('keydown',onKeyDown))),o.listenTo('preUpdate',((e,t)=>{if(e&&(e.item!==o.props.item||e.reselectRefreshId!==o.props.reselectRefreshId)){if(o.props.item===o.state.history[o.state.iHistory])return;if(o.props.item===o.state.history[o.state.iHistory+1])o.setState({iHistory:o.state.iHistory+1,isAlive:!1});else if(o.props.item){const e=o.state.history.slice(0,o.state.iHistory+1).concat([o.props.item]);o.setState({history:e,iHistory:e.length-1,isAlive:!1})}!o.state.isAlive&&bringAlive()}})),o.onHistory=e=>{const t=e>o.state.iHistory;o.setState({iHistory:Math.min(Math.max(0,e),o.state.history.length-1),isAlive:!1}),o.props.onHistoryItem&&o.props.onHistoryItem(o.state.history[o.state.iHistory]),bringAlive(),o.setTimer(null,(()=>{var e,i;const n=[...(null===(e=o.queryElement('div.style-ui-panel'))||void 0===e?void 0:e.querySelectorAll('button.history-button:not([disabled])'))||[]];null===(i=n[t?1:0]||n[0])||void 0===i||i.focus()}),5)};const getHeadingProps=()=>({idToScroll:o.state.history[o.state.iHistory].treeNode,onItemLink:o.props.onItemLink,history:o.state.history,iHistory:o.state.iHistory,onHistory:o.onHistory}),renderDebugTip=()=>wrapTip(t.MixDOM.def('div',null,'Click to open the nested host in its own debug window.',t.MixDOM.def('br',null),' - Click with ',t.MixDOM.def('b',null,'Shift'),' to toggle inclusion for all hosts.')),onPressHostToggle=e=>{var t;const i=null===(t=o.props.item.treeNode.def)||void 0===t?void 0:t.host;i&&o.props.toggleSubHost&&o.props.toggleSubHost(i,e.shiftKey||o.props.includeAllHosts?'mode':null)},onPressDebug=()=>{var e;const t=null===(e=o.props.item.treeNode.def)||void 0===e?void 0:e.host;if(!t)return;const i=window.open(void 0,'_blank','toolbar=0,scrollbars=0,location=0,resizable=1');if(i){i.addEventListener('beforeunload',(()=>{i.MixDOMDebug&&i.MixDOMDebug.stopDebug(!0)}));const e=[...document.body.children].find((e=>{var t;return'SCRIPT'===e.tagName&&(null===(t=e.getAttribute('src'))||void 0===t?void 0:t.includes('MixDOMDebug.js'))})),n=[...document.head.children].find((e=>{var t;return'LINK'===e.tagName&&'stylesheet'===e.getAttribute('rel')&&(null===(t=e.getAttribute('href'))||void 0===t?void 0:t.includes('MixDOMDebug.css'))})),s=i.document.createElement('script');s.setAttribute('type','text/javascript'),s.setAttribute('src',e?e.getAttribute('src'):'https://unpkg.com/mix-dom-debug/MixDOMDebug.js'),s.addEventListener('load',(()=>{i.setTimeout((()=>i.MixDOMDebug.startDebug(t,Object.assign(Object.assign({},o.props.debugInfo),{addRoot:!0,useFadeIn:!0,cssUrl:n&&n.getAttribute('href')||void 0}))))})),i.document.body.appendChild(s)}},n={className:'layout-border-box',style:'max-width: 800px; max-height: 50vh;'},onTipEnter=()=>'select-tip'===o.props.rowMode&&o.state.isAlive&&o.props.onTipPresence&&o.props.onTipPresence(o.state.history[o.state.iHistory].treeNode,'popup',!0),onTipLeave=()=>'select-tip'===o.props.rowMode&&o.state.isAlive&&o.props.onTipPresence&&o.props.onTipPresence(o.state.history[o.state.iHistory].treeNode,'popup',!1);return(e,s)=>{var l,r,a,d,c;const p=o.state.history[o.state.iHistory],u=p.treeNode;let f,M=!0,g=!0,h=null,m=null,x=null;switch(u.type){case'dom':{let e,o='';switch(getItemTypeFrom(u)){case'dom-text':e='Text node';break;case'dom-external':e='External node',o=p.description;break;case'dom-pseudo':e='Pseudo element',o=p.description;break;default:e=(u.domNode&&void 0!==u.domNode.ownerSVGElement?'SVG':'HTML')+' element',o=p.description}h=t.MixDOM.def(UIAppTipHeading,Object.assign({title:e,extraTitle:t.MixDOM.def(Prettify,{code:o?escapeHTML(o):p.description,className:'layout-padding-l layout-inline-block'})},getHeadingProps()));break}case'boundary':{const o=u.def.tag,i=u.boundary.component,n='Remote'===i.constructor.MIX_DOM_CLASS?i.getHost().findTreeNodes(['pass'],0,!0,(e=>e.def.getRemote&&e.def.getRemote()===i)):null;h=t.MixDOM.def(UIAppTipHeading,Object.assign({_key:'heading',title:'Remote'===o.MIX_DOM_CLASS?'Remote component':i.contextAPI?t.MixDOM.def(t.MixDOM.Fragment,null,'Component ',t.MixDOM.def('span',{class:'style-text-small'},'(with ContextAPI)')):'Component',extraTitle:t.MixDOM.def('b',{class:'style-color-emphasis layout-padding-l-x layout-padding-m-y layout-inline-block'},p.name||'Anonymous')},getHeadingProps())),m=t.MixDOM.def(t.MixDOM.Fragment,null,t.MixDOM.def(UIAppTipSection,{_key:'code',type:'code',title:'JS code',useDefaultLimits:!1},t.MixDOM.def(PrettifyDelay,Object.assign({origCode:o.toString(),prePrettifier:beautify,tag:'pre'},getMiniScrollableProps()))),i.props&&void 0!==Object.keys(i.props)[0]?t.MixDOM.def(UIAppTipSection,{_key:'props',type:'props',title:'Props',debugInfo:e.debugInfo,debugTarget:i.props},t.MixDOM.def(RenderComponentPartList,{component:i,part:'props'})):null,i.state&&void 0!==Object.keys(i.state)[0]?t.MixDOM.def(UIAppTipSection,{_key:'state',type:'state',title:'State',debugInfo:e.debugInfo,debugTarget:i.state},t.MixDOM.def(RenderComponentPartList,{component:i,part:'state'})):null,i.contextAPI&&void 0!==Object.keys(i.contextAPI.getContexts())[0]?t.MixDOM.def(UIAppTipSection,{_key:'contexts',type:'contexts',title:'Contexts',debugInfo:e.debugInfo,debugTarget:null===(l=i.contextAPI)||void 0===l?void 0:l.getContexts()},t.MixDOM.def(RenderComponentPartList,{component:i,part:'contexts'})):null),x=t.MixDOM.def(t.MixDOM.Fragment,null,i.wired&&i.wired.size?t.MixDOM.def(UIAppTipSection,{_key:'wired',type:'wired',title:'Wired components'},t.MixDOM.def(RenderComponentWiredChildren,{wired:i.wired,onItemLink:e.onItemLink})):null,n&&n[0]?t.MixDOM.def(UIAppTipSection,{_key:'remote',type:'remote',title:'Remote passes'},t.MixDOM.def(RenderComponentRemoteChildren,{remote:i,remotePasses:n,onItemLink:e.onItemLink})):null,u.boundary.innerBoundaries[0]?t.MixDOM.def(UIAppTipSection,{_key:'children',type:'children',title:'Inner components'},t.MixDOM.def(RenderComponentChildren,{treeNode:u,onItemLink:e.onItemLink})):null);break}case'root':{M=!1,g=!1,h=t.MixDOM.def(UIAppTipHeading,Object.assign({title:t.MixDOM.def('span',{class:'layout-padding-l-x layout-padding-m-y layout-inline-block'},'Root container'),extraTitle:p.description?t.MixDOM.def(Prettify,{code:escapeHTML(p.description),className:'layout-padding-l layout-border-box layout-inline-block'}):void 0,afterTitle:p.description?void 0:t.MixDOM.def('span',{class:'style-text-small'},p.treeNode.parent?'(element inherited)':'(no element)')},getHeadingProps()),t.MixDOM.def('ul',{class:'style-ui-list'},t.MixDOM.def('li',null,'Element that contains the ',e.item.level?'nested':'debugged',' host.')));const o=null===(a=null===(r=u.children[0])||void 0===r?void 0:r.boundary)||void 0===a?void 0:a.host.settings;m=o?t.MixDOM.def(UIAppTipSection,{_key:'settings',type:'settings',title:'Host settings',debugInfo:e.debugInfo,debugTarget:o},t.MixDOM.def(RenderPartList,{portion:o||{}})):null;break}case'host':{const i=u.def.host,n=o.getHost()===i,s=o.props.includedSubHosts&&o.props.includedSubHosts.includes(i)||!1;g=s,h=t.MixDOM.def(UIAppTipHeading,Object.assign({title:t.MixDOM.def('span',{class:'layout-padding-l-x layout-padding-m-y layout-inline-block'},'Nested host')},getHeadingProps()),t.MixDOM.def('ul',{class:'style-ui-list'},t.MixDOM.def('li',null,'Contains another host instance',n?', which is actually this debugger\'s host.':'. You can debug it, too.'),t.MixDOM.def('li',null,n?null:t.MixDOM.def(UIAppButton,{look:'edge',onPress:onPressHostToggle,renderTip:renderDebugTip,toggled:s},s?'Exclude from this debug'+(o.props.includeAllHosts?' and disable auto inclusion':''):'Include in this debug')),t.MixDOM.def('li',null,n?null:t.MixDOM.def(UIAppButton,{look:'edge',onPress:onPressDebug,renderTip:renderDebugTip},'Open in new debug window'))));const l=i.settings;m=t.MixDOM.def(UIAppTipSection,{_key:'settings',type:'settings',title:'Host settings',debugInfo:e.debugInfo,debugTarget:l},t.MixDOM.def(RenderPartList,{portion:l||{}})),f=g&&i&&i.groundedTree.children[0]?t.MixDOM.readDOMString(i.groundedTree.children[0],!1,0,null):'';break}case'pass':h=t.MixDOM.def(UIAppTipHeading,Object.assign({title:t.MixDOM.def('span',{class:'layout-padding-l-x layout-padding-m-y layout-inline-block'},u.def.getRemote?'Remote pass':'Content pass'),afterTitle:readComponentOneLine(u,null,!0)},getHeadingProps())),x=t.MixDOM.def(t.MixDOM.Fragment,null,(null===(d=u.boundary)||void 0===d?void 0:d.innerBoundaries[0])?t.MixDOM.def(UIAppTipSection,{_key:'children',type:'children',title:'Inner components'},t.MixDOM.def(RenderComponentChildren,{treeNode:u,onItemLink:e.onItemLink})):null);break;case'portal':{const e=t.MixDOM.def(Prettify,{code:escapeHTML(p.description),className:'layout-padding-l layout-border-box layout-inline-block'});h=t.MixDOM.def(UIAppTipHeading,Object.assign({title:t.MixDOM.def('span',{class:'layout-padding-l-x layout-padding-m-y layout-inline-block'},'Portal'),afterLogTarget:(null===(c=p.treeNode)||void 0===c?void 0:c.domNode)||null,afterTitle:t.MixDOM.def('span',{class:'style-color-dim'},' to '),afterLogTitle:e},getHeadingProps()),t.MixDOM.def('ul',{class:'style-ui-list'},t.MixDOM.def('li',null,'Portal allows to insert the rendered content in another location in the DOM.')));break}case'':h=t.MixDOM.def(UIAppTipHeading,Object.assign({title:t.MixDOM.def('span',{class:'layout-padding-l-x layout-padding-m-y layout-inline-block'},'Empty')},getHeadingProps()),t.MixDOM.def('ul',{class:'style-ui-list'},t.MixDOM.def('li',null,'Empty treeNodes should not typically end up in the grounded tree.')))}return g&&void 0===f&&(f=t.MixDOM.readDOMString(u,!1,0,null)),f&&!f.trim().startsWith('<')&&(f=JSON.stringify(f)),t.MixDOM.def('div',{class:i.classNames('style-ui-panel flex-col',n.className,s.isAlive?'layout-auto-pointer':'layout-no-pointer'),style:n.style,onMouseEnter:onTipEnter,onMouseLeave:onTipLeave},h,t.MixDOM.def('div',{class:'layout-scrollable style-scrollable flex-col layout-gap-m layout-padding-m-x'},m,M?t.MixDOM.def(RenderedByComponents,{treeNode:u,iUpdate:e.iUpdate,onItemLink:e.onItemLink}):null,x,f?t.MixDOM.def(UIAppTipSection,{type:'renders',title:'Renders in DOM',useDefaultLimits:!1},t.MixDOM.def(PrettifyDelay,Object.assign({origCode:f.replace(/\t/g,'    '),prePrettifier:escapeHTML,tag:'pre'},getMiniScrollableProps('layout-padding-l')))):null))}},M=t.mixFuncsWith(MixPositionedPopup,((e,o)=>{o.state=Object.assign(Object.assign({},o.state),{item:o.props.item,elementMargin:15,containerMargin:10,popupFadeIn:100,popupFadeOut:270});const onHistoryItem=e=>{o.setState({popupSourceElement:o.props.getSourceElement?o.props.getSourceElement(e.id):null})};return o.popupContainer=p,o.renderPopup=()=>o.state.item?t.MixDOM.def(UIAppTipDisplay,{item:o.state.item,iUpdate:o.props.iUpdate,onItemLink:o.props.onItemLink,debugInfo:o.props.debugInfo,reselectRefreshId:o.props.reselectRefreshId,onHistoryItem,onTipPresence:o.props.onTipPresence,escToCloseTip:!0,rowMode:o.props.rowMode,includedSubHosts:o.props.includedSubHosts,includeAllHosts:o.props.includeAllHosts,toggleSubHost:o.props.toggleSubHost}):null,o.listenTo('preUpdate',((e,t,i)=>{const n=o.props;if(e&&(e.item!==n.item||e.iUpdate!==n.iUpdate||e.onItemLink!==n.onItemLink||e.debugInfo!==n.debugInfo||e.reselectRefreshId!==n.reselectRefreshId||e.onTipPresence!==n.onTipPresence||e.rowMode!==n.rowMode||e.includedSubHosts!==n.includedSubHosts||e.includeAllHosts!==n.includeAllHosts||e.toggleSubHost!==n.toggleSubHost||t&&t.popupSourceElement!==o.state.popupSourceElement)&&(o.refreshPopupId={}),e&&e.item!==n.item)if(n.item){const e=n.getSourceElement?n.getSourceElement():null;o.setState({item:n.item,popupSourceElement:e}),o.showPopup()}else o.state.popupOpened&&'out'!==o.state.popupOpened&&o.hidePopup();t&&t.popupOpened&&!o.state.popupOpened&&o.setState({item:null,popupSourceElement:null})})),()=>t.MixDOM.def(o.WithTooltip,null)}),null),UITreeNodeType=(e,o)=>{const renderConceptTip=()=>wrapTip(t.MixDOM.def('div',null,'Filter by view by type: ',t.MixDOM.def('b',null,getItemTypeFrom(o.props.item.treeNode)),'.',t.MixDOM.def('br',null),' - Click with ',t.MixDOM.def('b',null,'Ctrl'),'/',t.MixDOM.def('b',null,'Alt'),' to only filter this type.'));let n=null;const onRowClick=e=>{if('click'!==e.type||!n||e.clientX===n[0]&&e.clientY===n[1]){const t=o.props.rowMode||'tip';'tip'===t?o.props.onToggleTip&&o.props.onToggleTip(e):(o.props.onSelectItem&&o.props.onSelectItem(e),'select-tip'===t&&o.props.onTipPresence&&o.props.onTipPresence(o.props.item.treeNode,'hoverable',!1))}n=null},onRowMouseDown=e=>{n=[e.clientX,e.clientY]},onRowMouseEnter=e=>{'select-tip'===o.props.rowMode&&o.props.onTipPresence&&o.props.onTipPresence(o.props.item.treeNode,'hoverable',!0)},onRowMouseLeave=e=>{'select-tip'===o.props.rowMode&&o.props.onTipPresence&&o.props.onTipPresence(o.props.item.treeNode,'hoverable',!1)};return(e,o)=>{const n=e.item,s=n.treeNode;let l=null;switch(s.type){case'dom':l=t.MixDOM.def(Prettify,{code:escapeHTML(n.description),className:'style-text-ellipsis'});break;case'pass':case'boundary':l=readComponentOneLine(s);break;case'portal':l=n.description?t.MixDOM.def(t.MixDOM.Fragment,null,t.MixDOM.def('span',{class:'style-color-dim'},'Portal to '),t.MixDOM.def(Prettify,{code:escapeHTML(n.description),className:'style-text-ellipsis'})):t.MixDOM.def('b',null,'Portal');break;case'root':l=t.MixDOM.def(t.MixDOM.Fragment,null,t.MixDOM.def('b',null,'Root container '),t.MixDOM.def(Prettify,{code:escapeHTML(n.description),className:'style-text-ellipsis'}));break;case'host':l=t.MixDOM.def('b',null,'Nested host');break;case'':l=t.MixDOM.def('b',null,'Empty')}const r=getItemTypeFrom(s);return t.MixDOM.def('div',{class:i.classNames('flex-row flex-align-items-center flex-grow layout-overflow-hidden layout-gap-m layout-fit-height',e.className)},t.MixDOM.def('span',{class:i.classNames('description layout-fit-height flex-row flex-align-items-center flex-grow layout-overflow-hidden',e.displayClassName),onMouseEnter:onRowMouseEnter,onMouseLeave:onRowMouseLeave,onMouseDown:onRowMouseDown,onClick:onRowClick},t.MixDOM.def('div',{class:'layout-gap-m flex-row flex-align-items-baseline flex-grow layout-overflow-hidden'},l)),t.MixDOM.def(UIAppButton,{look:'filled',className:i.classNames('type style-ui-concept style-fill-app-type-'+r,e.conceptClassName),onPress:e.onSelectConcept,renderTip:renderConceptTip},r))}};function UIAppTreeItem(e,o){o.state={};const onToggle=e=>{o.props.toggleCollapsed&&o.props.toggleCollapsed(o.props.item,e.shiftKey?'level':e.ctrlKey||e.metaKey?'siblings':e.altKey?'chain':'self')},onSelect=e=>{o.props.toggleSelected&&o.props.toggleSelected(o.props.item,e.shiftKey?'level':e.ctrlKey||e.metaKey?'siblings':e.altKey?'reset':'self')},onSelectConcept=e=>{o.props.toggleConcept&&o.props.toggleConcept(getItemTypeFrom(o.props.item.treeNode),e.ctrlKey||e.altKey||e.metaKey)},onToggleTip=e=>{o.props.onToggleTip&&o.props.onToggleTip(o.props.item.treeNode)},onViewInConsole=e=>{const t=o.props.item;switch(t.treeNode.type){case'boundary':consoleLog(o.props.debugInfo,'MixDOMDebug: Log component',t.treeNode.boundary.component);break;case'root':case'dom':case'portal':consoleLog(o.props.debugInfo,'MixDOMDebug: Log DOM element',t.treeNode.domNode);break;case'host':consoleLog(o.props.debugInfo,'MixDOMDebug: Log nested host',t.treeNode.def.host);break;default:consoleLog(o.props.debugInfo,'MixDOMDebug: Log treeNode',t.treeNode)}};o.listenTo('didMount',(()=>{o.props.animate&&o.setTimer(null,(()=>o.setState({animFinished:!0})),25)}));const renderToggleTip=()=>wrapTip(t.MixDOM.def('div',null,'Click to collapse/uncollapse the item.',t.MixDOM.def('br',null),' - Click with ',t.MixDOM.def('b',null,'Shift'),' to toggle all items in the same level.',t.MixDOM.def('br',null),' - Click with ',t.MixDOM.def('b',null,'Ctrl'),' to toggle all siblings.',t.MixDOM.def('br',null),' - Click with ',t.MixDOM.def('b',null,'Alt'),' to toggle between expanding all or only this item and its parents and children.')),renderSelectTip=()=>wrapTip(t.MixDOM.def('div',null,'Click to select/deselect this item.',t.MixDOM.def('br',null),' - Click with ',t.MixDOM.def('b',null,'Shift'),' to toggle all items in the same level.',t.MixDOM.def('br',null),' - Click with ',t.MixDOM.def('b',null,'Ctrl'),' to toggle all siblings.',t.MixDOM.def('br',null),' - Click with ',t.MixDOM.def('b',null,'Alt'),' to reset selection to this item.')),renderConsoleTip=()=>wrapTip(t.MixDOM.def('div',null,'Click to log the item in console.')),renderTipTip=()=>wrapTip(t.MixDOM.def('div',null,'Click to open the details popup.'));return(e,o)=>{const n=6*e.item.level,s=`style-stroke-app-type-${getItemTypeFrom(e.item.treeNode)}`;return t.MixDOM.def('div',{role:'treeitem',class:i.classNames('ui-app-tree-item layout-fit-height layout-margin-m-x flex-row flex-align-items-center layout-gap-m style-hoverable',e.dimmed&&'style-disabled',e.animate&&(o.animFinished?'style-opacity-1':'style-opacity-0')),style:{marginLeft:n+'px'}},t.MixDOM.def('div',{class:i.classNames('level-indicator',e.selected?'style-dimmed':'style-disabled',e.selected&&s),style:`position: absolute; left: 0; height: 100%; width: ${n}px; background: linear-gradient(-160deg, currentColor, ${e.selected?'35%':'15%'}, transparent, 100%, transparent);`}),t.MixDOM.def(UIAppButton,{onPress:onSelect,iconName:e.selected?'item-selected':'item-deselected',className:'flex-align-self-center',iconClassName:i.classNames(!e.selected&&'style-dimmed',s),look:'transparent',renderTip:renderSelectTip}),t.MixDOM.def(UIAppButton,{onPress:onToggle,invisible:null===e.collapsed,disabled:null===e.collapsed||void 0,iconName:null===e.collapsed?'':e.collapsed?'collapsed':'expanded',look:'transparent',renderTip:renderToggleTip}),t.MixDOM.def(UITreeNodeType,{item:e.item,iUpdate:e.iUpdate,displayClassName:e.dimmed?'style-greyed':void 0,conceptClassName:e.dimmed?'style-greyed':void 0,rowMode:e.rowMode,onSelectItem:onSelect,onSelectConcept,onTipPresence:e.onTipPresence,onToggleTip}),t.MixDOM.def(UIAppButton,{onPress:onToggleTip,iconName:'info',look:'transparent',renderTip:renderTipTip}),t.MixDOM.def(UIAppButton,{onPress:onViewInConsole,iconName:'console',look:'transparent',renderTip:renderConsoleTip}))}}const g={component:'[component]',root:'[root] root container',host:'[host] nested host',pass:'[pass] content pass from','pass-remote':'[pass] remote pass from',portal:'[portal] portal to',empty:'[empty]',dom:'[dom]','dom-element':'[dom] [dom-element]','dom-text':'[dom] [dom-text]','dom-external':'[dom] [dom-external]','dom-pseudo':'[dom] [dom-pseudo]'};function matchesFilter(e,t){return t&&t.some((t=>t.every((t=>{var o;return(e.name||('boundary'===e.treeNode.type?'Anonymous':'')).toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||(g[(null===(o=e.treeNode.def)||void 0===o?void 0:o.getRemote)?'pass-remote':getItemTypeFrom(e.treeNode)]||'').includes(t)}))))}function modifyIds(e,t,o,i){switch(o){case'reset':return t.filter((e=>i.includes(e)));case'invert':return i.filter((e=>!t.includes(e)));case'add':return e.concat(t.filter((t=>!e.includes(t)&&i.includes(t))));case'remove':return e.filter((e=>!t.includes(e)));default:return e.slice()}}function isItemWithinCollapsed(e,t){let o=e.parent;for(;o;){if(t.includes(o.id))return!0;o=o.parent}return!1}function findItemsIdsBy(e,t,o,i){var n,s;const l=o.indexOf(e.id),r=-1===l;switch(t){case'level':{const t=e.level,n=i.filter((e=>e.level===t)).map((e=>e.id));return r?[...o,...n.filter((e=>!o.includes(e)))]:o.filter((e=>!n.includes(e)))}case'siblings':{const t=(null===(s=null===(n=e.parent)||void 0===n?void 0:n.children)||void 0===s?void 0:s.map((e=>e.id)))||[e.id];return r?[...o,...t.filter((e=>!o.includes(e)))]:o.filter((e=>!t.includes(e)))}case'chain':case'parents':{const n=[e.id];let s=e.parent;for(;s;)n.push(s.id),s=s.parent;if('chain'===t){let t,o=e.children||[],i=0;for(;t=o[i++];)n.push(t.id),t.children&&(o=t.children.concat(o.slice(i)),i=0)}const l=i.filter((e=>!n.includes(e.id))).map((e=>e.id));return o.length!==l.length||o.some((e=>n.includes(e)))?l:[]}case'reset':return r||1!==o.length?[e.id]:[];default:return o=o.slice(),r?o.push(e.id):o.splice(l,1),o}}const h=function UIAppHostTree(o,s,l){s.iMatchCycle=-1,s.state={host:null,settings:null,iUpdate:0,selected:[],collapsed:[],tipItem:null,filterSplits:null,showCollapsed:!1,showParents:!1,showChildren:!1,ignoreSelection:!1,ignoreFilter:!1,rowMode:'select-tip',hideUnmatched:!1,includeAllSubHosts:!1,includedSubHosts:[],reselectRefreshId:{}},l.listenToData('debug.host','debug.settings','debug.iUpdate','state',((e,t,o,i)=>{const n=i||Object.assign({filter:''},s.state),l=n.filter.replace(/\,/g,' ').trim()?n.filter.split(',').map((e=>e.trim().split(' ').map((e=>e.trim().toLowerCase())).filter((e=>e)))).filter((e=>void 0!==e[0])):null;s.setState({host:e,settings:t,iUpdate:o,filterSplits:l&&void 0!==l[0]&&l||null,showCollapsed:n.showCollapsed,showParents:n.showParents,showChildren:n.showChildren,hideUnmatched:n.hideUnmatched,ignoreFilter:n.ignoreFilter,ignoreSelection:n.ignoreSelection,rowMode:n.rowMode})}),[s.state.host,s.state.settings,s.state.iUpdate]);const r=new t.MixDOM.Ref,a=n.createMemo(((e,t,o)=>({debugInfo:e,animate:!0,iUpdate:t,rowMode:o,toggleCollapsed,toggleSelected,toggleConcept,onToggleTip,onTipPresence}))),toggleSubHost=(e,t)=>{if(e!==s.getHost())if(s.state.includedSubHosts.includes(e)){if(!0===t)return;l.sendSignal('state.disconnectSubHost',e),s.setInState('includedSubHosts',s.state.includedSubHosts.filter((t=>t!==e))),'mode'===t&&s.setInState('includeAllSubHosts',!1)}else{if(!1===t)return;l.sendSignal('state.connectSubHost',e),s.setInState('includedSubHosts',s.state.includedSubHosts.concat([e])),'mode'===t&&s.setInState('includeAllSubHosts',!0)}};l.listenTo('state.modifySubHosts',(e=>{if('boolean'==typeof e)!e&&s.state.includedSubHosts.forEach((e=>toggleSubHost(e,!1))),s.setInState('includeAllSubHosts',e);else{const t=s.state.host&&s.state.host.findTreeNodes(['host'],0,!0).map((e=>e.def&&e.def.host)).filter((e=>e))||[];s.setState({includedSubHosts:e.filter((e=>t.includes(e)))})}}));const d=n.createMemo(((e,t,o,n)=>{const r=t[0]?new Set(t):null,a=function flattenTreeWith(e,t,o){o||(o='children');const i=[];let n,s=e.map((e=>[e,null,0])),l=0,r=!1;const ignoreKids=()=>r=!0;for(;n=s[l++];){const[e,a,d]=n,c=t(e,a,d,ignoreKids);if(c)if(i.push(c),r)r=!1;else if(e[o]){const t=d+1;s=e[o].map((e=>[e,c,t])).concat(s.slice(l)),l=0}}return i}(e?[e.groundedTree]:[],((e,n,l,a)=>{let d='',c='';switch(e.type){case'pass':{let t;[c,t]=getPassPhraseAndSource(e),d=t?t._outerDef.tag.name||'Anonymous':'';break}case'boundary':c=e.def.tag?e.def.tag.name:'',d=e.def.tag?e.def.tag.toString():'';break;case'dom':{c=e.def.tag||'';let t,o='',n=!1,s='';switch(getItemTypeFrom(e)){case'dom-external':n=!0,t=e.def.domContent;break;case'dom-pseudo':n=!0,t=e.def.domElement;break;case'dom-text':s=null==e.def.domContent?'':'string'==typeof e.def.domContent?JSON.stringify(e.def.domContent):e.def.domContent.toString();break;default:o=e.def.tag,n=!(!o||!e.children[0])}d=i.readDOMString(o,e.def.props,n?null:s,t),n&&(d=d.replace('/>','>'));break}case'root':{const t=e.domNode;c='Root',t&&(d=i.readDOMString(t?t.tagName.toLowerCase():'',null,!1,t).replace('/>','>'));break}case'host':{c='Host';const i=e.def.host;r&&r.delete(i);const n=t.includes(i);!n&&a(),o&&!n&&i!==s.getHost()&&toggleSubHost(i,!0);break}case'portal':{c='Portal';const t=(e.def.props||{}).container;d=i.readDOMString(t?t.tagName.toLowerCase():'body',e.def.props,!1,t||function getDocBodyBy(e){var t;let o=e;for(;o;){if(o.domNode)return(null===(t=o.domNode.ownerDocument)||void 0===t?void 0:t.body)||null;o=o.parent}return null}(e)),d=d.replace('/>','>');break}}const p={id:e,treeNode:e,parent:n,level:l,name:c,description:d};return n&&(n.children?n.children.push(p):n.children=[p]),p})),d=a.map((e=>e.id)),c=s.state.collapsed.filter((e=>d.includes(e)));c.length!==s.state.collapsed.length&&setCollapsed(c);const p=s.state.selected.filter((e=>d.includes(e)));if(p.length!==s.state.selected.length&&setSelected(p),r&&r.size){for(const e of r)l.sendSignal('state.disconnectSubHost',e);s.setInState('includedSubHosts',s.state.includedSubHosts.filter((e=>!r.has(e))))}return a}));let c=d(s.state.host,s.state.includedSubHosts,s.state.includeAllSubHosts,s.state.iUpdate);const areNoneCollapsed=(e=s.state.collapsed)=>void 0===e[0],setCollapsed=e=>{const t=areNoneCollapsed();areNoneCollapsed(e)!==t&&l.setInData('state.noneCollapsed',!t),s.setInState('collapsed',e)},toggleCollapsed=(e,t)=>{setCollapsed(findItemsIdsBy(e,t||'self',s.state.collapsed,c.filter((e=>e.children&&void 0!==e.children[0]))))},toggleConcept=(e,t)=>{let o=l.getInData('state.filter','');const i='['+e+']';let n=o?o.split(','):[];const s=n.map((e=>e.trim().toLowerCase())),r=s.findIndex((e=>e===i));if(t){const e=['component','dom','dom-element','dom-text','dom-external','dom-pseudo','host','pass','portal','root','empty'].map((e=>'['+e+']')),t=s.filter((t=>!e.includes(t)||t===i));t.length===n.length?-1!==r?n.splice(r,1):n.push(void 0===n[0]?i:' '+i):(n=t,-1===r&&n.push(void 0===n[0]?i:' '+i))}else-1!==r?n.splice(r,1):n.push(void 0===n[0]?i:' '+i);l.setInData('state.filter',n.join(','))};l.listenTo('state.toggleCollapseAll',(()=>{setCollapsed(areNoneCollapsed()?c.filter((e=>e.children&&void 0!==e.children[0])).map((e=>e.id)):[])})),l.listenTo('state.modifyCollapsed',((e,t)=>{setCollapsed(modifyIds(s.state.collapsed,e,t,c.map((e=>e.treeNode))))}));let p=!0;const whetherShouldSelect=(e=s.state.selected,t=!1)=>h?h.some((t=>!e.includes(t.id)))||t&&(m&&m.some((t=>!e.includes(t.id)))||x&&x.some((t=>!e.includes(t.id))))||!1:void 0===e[0],setSelected=e=>{const t=s.state.selected[s.iMatchCycle],o=void 0!==t?e.indexOf(t):-1;-1!==o?s.iMatchCycle+=o-s.iMatchCycle:s.iMatchCycle>=0&&s.iMatchCycle--;const i=s.state.filterSplits,n=i&&h?h.some((t=>!e.includes(t.id)&&matchesFilter(t,i))):void 0===e[0];n!==p&&l.setInData('state.shouldSelect',p=n),s.setInState('selected',e)},toggleSelected=(e,t)=>{setSelected(findItemsIdsBy(e,t||'self',s.state.selected,c))};l.listenTo('state.toggleSelectMatched',(e=>{let t=[];if(!h||!s.state.hideUnmatched&&e)void 0===s.state.selected[0]&&(t=c.map((e=>e.id)));else{const o=h.map((e=>e.id)).concat(e?(m&&m.map((e=>e.id))||[]).concat(x&&x.map((e=>e.id))||[]):[]);t=(e?void 0===s.state.selected.filter((e=>o.includes(e)))[0]:whetherShouldSelect())?o:s.state.selected.filter((e=>!o.includes(e)))}setSelected(t)})),l.listenTo('state.modifySelected',((e,t)=>{setSelected(modifyIds(s.state.selected,e,t,c.map((e=>e.treeNode))))})),l.listenTo('state.scrollToMatched',((e,t)=>{const o=h?t||s.state.showCollapsed?h:h.filter((e=>!isItemWithinCollapsed(e,s.state.collapsed))):[];if(!o[0])return;s.iMatchCycle=e?s.iMatchCycle-1<0?o.length-1:s.iMatchCycle-1:s.iMatchCycle+1>=o.length?0:s.iMatchCycle+1;const i=o[s.iMatchCycle];scrollToItem(i)}));const onItemLink=(t,o)=>{const i=t?c.find((e=>e.id===t)):null;switch(o||'focus'){case'focus':if(!i)break;filterer(i)?scrollToItem(i):h&&s.state.hideUnmatched?s.state.ignoreSelection||s.state.selected.includes(i.treeNode)||(s.listenTo('didUpdate',(()=>{i&&scrollToItem(i)}),null,e.SignalListenerFlags.OneShot),setSelected([...s.state.selected,i.treeNode])):scrollToItem(i);break;case'details':setTipBy(i?i.id:null);break;case'details-break':{const e=i||s.state.tipItem,t=!!(1&y);setTipBy(i?i.id:null),setSkipHover(!t),e&&refocusToGrid(e.treeNode);break}case'log':i&&((e,t)=>{switch(t.treeNode.type){case'boundary':consoleLog(e,'MixDOMDebug: Log component',t.treeNode.boundary.component);break;case'root':case'dom':case'portal':consoleLog(e,'MixDOMDebug: Log DOM element',t.treeNode.domNode);break;case'host':consoleLog(e,'MixDOMDebug: Log nested host',t.treeNode.def.host);break;default:consoleLog(e,'MixDOMDebug: Log treeNode',t.treeNode)}})(s.state.settings,i)}},scrollToItem=async t=>{const o=r.getComponent(),i=s.state.collapsed;if(!o)return;let n=null,l=t.parent;for(;l;){const e=(n||i).indexOf(l.id);-1!==e&&(n||(n=i.slice()),n.splice(e,1)),l=l.parent}if(n){let t=new Promise((t=>(o||s).listenTo('didUpdate',(()=>(o||s).setTimer(null,t,20)),null,e.SignalListenerFlags.OneShot)));s.setInState('collapsed',n),await t}const a=c.filter(filterer).indexOf(t);-1!==a&&o.scrollToIndex(a,'instant',!0,(e=>{var t;return e&&(null===(t=e.querySelector('button'))||void 0===t?void 0:t.focus())}))},u=n.createMemo(((e,t,o)=>o||t?e.filter((e=>t&&t.includes(e.id)||o&&matchesFilter(e,o))):null)),f=n.createMemo((e=>{const t=[];for(const o of e){let i=o.parent;for(;i;)t.includes(i)||e.includes(i)||t.push(i),i=i.parent}return t})),g=n.createMemo(((e,t)=>{const o=[];for(const i of e){if(t.includes(i))continue;let e=i.parent;for(;e;){if(t.includes(e)){o.push(i);break}e=e.parent}}return o})),filterer=e=>!(!(s.state.hideUnmatched&&s.state.showCollapsed&&(!s.state.ignoreFilter&&s.state.filterSplits||!s.state.ignoreSelection&&void 0!==s.state.selected[0]))&&isItemWithinCollapsed(e,s.state.collapsed))&&(!h||!s.state.hideUnmatched||(!!h.includes(e)||(!(!m||!m.includes(e))||!(!x||!x.includes(e)))));let h=u(c,s.state.ignoreSelection||void 0===s.state.selected[0]?null:s.state.selected,s.state.ignoreFilter?null:s.state.filterSplits),m=h&&s.state.showParents?f(h):null,x=h&&s.state.showChildren?g(c,h):null,y=0,b=!1;const setSkipHover=(e=!0)=>(!e||(b=!0))&&s.setTimer('skip-hover',(()=>{}),300),refocusToGrid=(e,t)=>{var o,i;const n=r.getComponent();if(!n||!t&&(null===(o=n.getRootElement())||void 0===o?void 0:o.contains(document.activeElement)))return;let s=e&&getRowElement(e);s||(s=n.getFirstVisibleItem()),s&&(null===(i=s.querySelector('button'))||void 0===i||i.focus())},setTipBy=(e,t=!0)=>{e||(y&=-3),s.clearTimers('tip-hover','skip-hover'),s.setState({tipItem:e&&c.find((t=>t.id===e))||null,reselectRefreshId:t?{}:s.state.reselectRefreshId})};l.listenTo('state.setTipDisplay',setTipBy);const onToggleTip=e=>{var t;setTipBy((null===(t=s.state.tipItem)||void 0===t?void 0:t.treeNode)===e?null:e)},onTipPresence=(e,t,o)=>{if('select-tip'!==s.state.rowMode)return;const i='popup'===t?2:1;if(y=o?y|i:y&~i,o)'hoverable'===t?(!b&&!s.hasTimer('skip-hover')&&!(2&y)&&s.setTimer('tip-hover',(()=>setTipBy(e)),600),b=!1):setTipBy(e,!1);else{const e=s.state.tipItem;!y&&e?(setTipBy(null),'popup'===t&&(setSkipHover(),refocusToGrid(e.treeNode))):s.clearTimers('tip-hover')}},getTipSourceElement=e=>e||s.state.tipItem?getRowElement(e||s.state.tipItem.treeNode):null,getRowElement=e=>{var t;return(null===(t=r.getComponent())||void 0===t?void 0:t.getElementAt(c.filter(filterer).findIndex((t=>t.id===e))))||null},D=t.MixDOM.wired((()=>a(s.state.settings,s.state.iUpdate,s.state.rowMode)),((e,t,o)=>{const i=e.item,n=i.children&&void 0!==i.children[0],l=s.state.selected.includes(i.id);return Object.assign(Object.assign(Object.assign({},e),t),{collapsed:n?s.state.collapsed.includes(i.id):null,selected:l,dimmed:h?!h.includes(i):!s.state.ignoreSelection&&void 0!==s.state.selected[0]&&!l})}),UIAppTreeItem,'WiredTreeItem');s.addWired(D);const beforeUpdate=()=>{let e=h;c=d(s.state.host,s.state.includedSubHosts,s.state.includeAllSubHosts,s.state.iUpdate),h=u(c,s.state.ignoreSelection||void 0===s.state.selected[0]?null:s.state.selected,s.state.ignoreFilter?null:s.state.filterSplits),m=h&&s.state.showParents?f(h):null,x=h&&s.state.showChildren?g(c,h):null,e!==h&&p!==whetherShouldSelect()&&l.setInData('state.shouldSelect',p=!p)};return s.listenTo('beforeUpdate',beforeUpdate),(e,o)=>(beforeUpdate(),t.MixDOM.def('div',{class:i.classNames('ui-app-host-tree layout-fit-size',e.className),style:e.style},t.MixDOM.def('div',{class:'flex-row flex-align-items-center layout-fit-size'},t.MixDOM.def(UIList,{items:c,Item:D,keyProp:'id',filter:filterer,rowHeight:30,refreshId:{},listClassName:e.listClassName,refVirtualList:r})),t.MixDOM.def(M,{item:o.tipItem,iUpdate:o.iUpdate,onItemLink,getSourceElement:getTipSourceElement,debugInfo:o.settings,reselectRefreshId:o.reselectRefreshId,onTipPresence,rowMode:o.rowMode,includedSubHosts:o.includedSubHosts,includeAllHosts:o.includeAllSubHosts,toggleSubHost})))};var __rest$1=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&'function'==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const m=function UIAppTopBar(e,o,n){o.state={theme:'dark',filter:'',showCollapsed:!1,showParents:!1,showChildren:!1,hideUnmatched:!1,ignoreFilter:!1,ignoreSelection:!1,rowMode:'select-tip',shouldSelect:!0,noneCollapsed:!0},n.listenToData('state',(e=>{const t=e||o.state,i=__rest$1(t,['hiddenTipSections']);o.setState(Object.assign({},i))}));const setFilter=e=>{n.setInData('state.filter',e)},toggleFilterAuto=()=>n.setInData('state.showCollapsed',!o.state.showCollapsed),toggleFilterParents=()=>n.setInData('state.showParents',!o.state.showParents),toggleFilterChildren=()=>n.setInData('state.showChildren',!o.state.showChildren),toggleHideUnmatched=()=>n.setInData('state.hideUnmatched',!o.state.hideUnmatched),toggleIgnoreFilter=()=>n.setInData('state.ignoreFilter',!o.state.ignoreFilter),toggleIgnoreSelection=()=>n.setInData('state.ignoreSelection',!o.state.ignoreSelection),toggleRowMode=e=>n.setInData('state.rowMode','tip'===o.state.rowMode?'select-tip':'select-tip'===o.state.rowMode?'select':'tip'),toggleCollapseAll=()=>n.sendSignal('state.toggleCollapseAll'),toggleSelectMatched=e=>n.sendSignal('state.toggleSelectMatched',e.shiftKey),toggleTheme=()=>n.sendSignal('state.toggleTheme'),scrollToMatched=e=>n.sendSignal('state.scrollToMatched',e.ctrlKey||e.altKey||e.metaKey,e.shiftKey),logHost=()=>consoleLog(n.getInData('debug.settings'),'MixDOMDebug: Log host',n.getInData('debug.host')),renderCollapseTip=()=>wrapTip(t.MixDOM.def('div',null,'Click to collapse/uncollapse all.')),renderSelectTip=()=>wrapTip(t.MixDOM.def('div',null,'Click to select/deselect matched (or all).',t.MixDOM.def('br',null),' - Click with ',t.MixDOM.def('b',null,'Shift'),' to always select/deselect all (= including dimly visible).')),renderScrollToMatchedTip=()=>wrapTip(t.MixDOM.def('div',null,'Scroll and focus to the next match.',t.MixDOM.def('br',null),' - Click with ',t.MixDOM.def('b',null,'Ctrl'),'/',t.MixDOM.def('b',null,'Alt'),' to go backwards.',t.MixDOM.def('br',null),' - Click with ',t.MixDOM.def('b',null,'Shift'),' to include matched but collapsed by parents (= uncollapses parents).')),renderHideUnmatchedTip=()=>wrapTip(t.MixDOM.def('div',null,'Whether to always show all items, or only matched by filter and/or selection.')),renderIgnoreFilterTip=()=>wrapTip(t.MixDOM.def('div',null,'Disable the effect of the filter temporarily.')),renderIgnoreSelectionTip=()=>wrapTip(t.MixDOM.def('div',null,'Disable the effect of the selection temporarily.')),renderRowModeTip=()=>wrapTip(t.MixDOM.def('div',null,'Change the row mode:',t.MixDOM.def('br',null),' 1. Clicking toggles selection and hovering toggles tip display.',t.MixDOM.def('br',null),' 2. Clicking the row only toggles selection.',t.MixDOM.def('br',null),' 3. Clicking the row toggles the tip display.')),renderFilterAutoTip=()=>wrapTip(t.MixDOM.def('div',null,'Whether auto-expands collapsed parents when filtering.')),renderFilterParentsTip=()=>wrapTip(t.MixDOM.def('div',null,'Whether shows parents with matching children.')),renderFilterChildrenTip=()=>wrapTip(t.MixDOM.def('div',null,'Whether shows children of matching parents.')),renderThemesTip=()=>wrapTip(t.MixDOM.def('div',null,'Toggle color theme.')),renderInputTip=()=>wrapTip(t.MixDOM.def('div',null,'Filter items by keywords.',t.MixDOM.def('br',null),' - Separate by comma (',t.MixDOM.def('b',null,','),') and join by space (',t.MixDOM.def('b',null,' '),').',t.MixDOM.def('br',null),' - Use brackets for tags: [component], [dom], [portal], [pass], [host], [root]')),renderConsoleTip=()=>wrapTip(t.MixDOM.def('div',null,'Click to log the debugged ',t.MixDOM.def('b',null,'Host'),' instance in console.'));return(e,n)=>{const l=!!o.state.filter&&o.state.filter.replace(/\,/g,'').trim();return t.MixDOM.def('div',{class:'ui-app-top-bar layout-fit-width flex-row flex-align-items-center layout-gap-m layout-padding-m layout-border-box'},t.MixDOM.def(UIAppButton,{_key:'select',look:'transparent',escToCloseTip:!0,iconName:n.shouldSelect?'select-all':'select-none',onPress:toggleSelectMatched,renderTip:renderSelectTip}),t.MixDOM.def(UIAppButton,{_key:'collapse',look:'transparent',escToCloseTip:!0,iconName:n.noneCollapsed?'expanded':'collapsed',onPress:toggleCollapseAll,renderTip:renderCollapseTip}),t.MixDOM.def(UIAppButton,{_key:'scrollTo',look:'transparent',escToCloseTip:!0,iconName:'scroll-to',disabled:n.shouldSelect&&!l||void 0,onPress:scrollToMatched,renderTip:renderScrollToMatchedTip}),t.MixDOM.def(UIAppInput,{_key:'filter',look:'edge',type:'text',disabled:n.ignoreFilter,escToCloseTip:!0,escToClearInput:!0,value:n.filter,onValue:setFilter,className:i.classNames('flex-grow layout-fit-height style-text-bold',l&&'active'),placeholder:'filter items',renderTip:renderInputTip}),n.hideUnmatched?t.MixDOM.def(t.MixDOM.Fragment,null,t.MixDOM.def(UIAppButton,{_key:'showCollapsed',look:n.hideUnmatched?'transparent':'filled',escToCloseTip:!0,iconName:n.hideUnmatched?'filter-expanded':'filter-collapsed',disabled:!n.hideUnmatched||void 0,toggled:n.hideUnmatched&&n.showCollapsed,onPress:toggleFilterAuto,renderTip:renderFilterAutoTip}),t.MixDOM.def(UIAppButton,{_key:'showParents',look:n.hideUnmatched?'transparent':'filled',escToCloseTip:!0,iconName:'filter-parents',disabled:!n.hideUnmatched||void 0,toggled:n.hideUnmatched&&n.showParents,onPress:toggleFilterParents,renderTip:renderFilterParentsTip}),t.MixDOM.def(UIAppButton,{_key:'showChildren',look:n.hideUnmatched?'transparent':'filled',escToCloseTip:!0,iconName:'filter-children',disabled:!n.hideUnmatched||void 0,toggled:n.hideUnmatched&&n.showChildren,onPress:toggleFilterChildren,renderTip:renderFilterChildrenTip})):null,t.MixDOM.def(UIAppButton,{_key:'eye',look:'edge',escToCloseTip:!0,iconName:n.hideUnmatched?'show-matched':'show-all',onPress:toggleHideUnmatched,renderTip:renderHideUnmatchedTip}),t.MixDOM.def(UIAppButton,{_key:'ignoreFilter',look:'transparent',escToCloseTip:!0,iconName:'no-filter',toggled:n.ignoreFilter,onPress:toggleIgnoreFilter,renderTip:renderIgnoreFilterTip}),t.MixDOM.def(UIAppButton,{_key:'ignoreSelection',look:'transparent',escToCloseTip:!0,iconName:'no-selection',toggled:n.ignoreSelection,onPress:toggleIgnoreSelection,renderTip:renderIgnoreSelectionTip}),t.MixDOM.def(UIAppButton,{_key:'ignoreTip',look:'transparent',escToCloseTip:!0,iconName:'select'===n.rowMode?'click-select':'select-tip'===n.rowMode?'click-select-tip':'click-tip',onPress:toggleRowMode,renderTip:renderRowModeTip}),t.MixDOM.def('span',{_key:'mix-dom-debug'},t.MixDOM.def('b',null,'mix-dom-debug'),' ',t.MixDOM.def('span',{class:'style-text-small'},'(v',s,')')),t.MixDOM.def(UIAppButton,{_key:'theme',look:'transparent',escToCloseTip:!0,iconName:'theme',onPress:toggleTheme,renderTip:renderThemesTip}),t.MixDOM.def(UIAppButton,{_key:'console',look:'transparent',escToCloseTip:!0,iconName:'console',onPress:logHost,renderTip:renderConsoleTip}))}};function Article(){return t.MixDOM.def('article',{class:'flex-col layout-gap-m layout-margin-l layout-fit-width style-ui-blog'},t.MixDOM.Content)}function Section(){return t.MixDOM.def('section',{class:'flex-col layout-padding-l layout-border-box layout-gap-l layout-fit-width'},t.MixDOM.Content)}function Aside(){return t.MixDOM.def('aside',{class:'style-ui-panel layout-margin-l'},t.MixDOM.Content)}function Small(e){return t.MixDOM.def('span',{class:i.classNames('style-text-small',e.wide&&'layout-padding-m',e.italic&&'style-text-italic',e.bold&&'style-text-bold')},t.MixDOM.Content)}function H1(){return t.MixDOM.def('h1',{class:'style-text-center layout-margin-l layout-padding-l style-ui-heading main'},t.MixDOM.Content)}function H2(){return t.MixDOM.def('h2',{class:'style-text-center style-ui-heading'},t.MixDOM.Content)}function H3(){return t.MixDOM.def('h3',{class:'style-ui-heading'},t.MixDOM.Content)}function A(e){return t.MixDOM.def('a',{class:'style-ui-button style-ui-focusable focusable-look-edge size-narrow style-text-no-decoration',href:e.href,target:e.target||'_blank'},t.MixDOM.Content)}function Code(e){return t.MixDOM.def(Prettify,{code:e.code,className:'style-ui-mini-panel layout-overflow-hidden'})}function Pre(e){return t.MixDOM.def(Prettify,{tag:'pre',code:e.code,className:'style-ui-mini-panel layout-scrollable style-scrollable'})}const SectionTogglable=(e,o)=>{const renderSectionTip=()=>wrapTip(t.MixDOM.def('div',null,'Toggle the section visibility.',t.MixDOM.def('br',null),' - Click with ',t.MixDOM.def('b',null,'Ctrl'),'/',t.MixDOM.def('b',null,'Alt'),' to only show this section or all.')),onPress=e=>o.props.toggleSection&&o.props.toggleSection(o.props.name,e.ctrlKey||e.altKey||e.metaKey);return e=>t.MixDOM.def(Section,null,t.MixDOM.def(H2,null,t.MixDOM.def(UIAppButton,{look:'transparent',className:i.classNames(!e.visible&&'style-dimmed'),renderTip:renderSectionTip,onPress},e.title)),e.visible?t.MixDOM.Content:null)},UIAppInstructions=(e,o)=>{o.state={hiddenSections:[]};const toggleSection=(e,t)=>{let i=o.state.hiddenSections.slice();const n=i.indexOf(e);if(t){const t=['instructions','set-host','using-launcher','manual-launching','render-app'];i=i.length===t.length-1&&-1!==n?[]:t.filter((t=>t!==e))}else-1===n?i.push(e):i.splice(n,1);o.setInState('hiddenSections',i)},SectionHelper=e=>t.MixDOM.def(SectionTogglable,{title:e.title,name:e.name,visible:!o.state.hiddenSections.includes(e.name),toggleSection},t.MixDOM.Content);return()=>t.MixDOM.def('div',{class:'ui-app-instructions layout-fit-size layout-padding-l layout-border-box layout-scrollable style-scrollable flex-col flex-align-items-center'},t.MixDOM.def(Article,null,t.MixDOM.def(H1,null,'MixDOMDebug'),t.MixDOM.def(SectionHelper,{title:'Instructions',name:'instructions'},t.MixDOM.def('p',{class:'style-text-center'},'You are viewing instructions for setting up the debugger ',t.MixDOM.def(Small,null,'(because no Host instance was given)'),'.')),t.MixDOM.def(SectionHelper,{title:'Set host directly',name:'set-host'},t.MixDOM.def('p',{class:'style-text-center'},'Since you\'re seeing this page, the debugger app is already running and available ',t.MixDOM.def(Small,null,'(in this window)'),', and so is the globally declared ',t.MixDOM.def(Code,{code:'MixDOMDebug'}),' class.'),t.MixDOM.def(Aside,null,t.MixDOM.def(H3,null,'Changing the host'),t.MixDOM.def('p',null,'To start debugging a Host instance in this window ',t.MixDOM.def(Small,null,'(',t.MixDOM.def(Code,{code:'debugWindow'}),')'),' from another window, simply call: ',t.MixDOM.def(Pre,{code:'debugWindow.MixDOMDebug.startDebug( host ); // Feed in the `host` to debug.'})),t.MixDOM.def('p',null,'Or you can use the ',t.MixDOM.def(Code,{code:'setHost(host, settings, appState)'}),' and ',t.MixDOM.def(Code,{code:'clearHost()'}),' methods directly: ',t.MixDOM.def(Pre,{code:'debugWindow.MixDOMDebug.debug.setHost( host );'})),t.MixDOM.def('p',null,'Note that there\'s only 1 ',t.MixDOM.def(Small,null,'(or 0)'),' instance at a time, accessible at: ',t.MixDOM.def(Code,{code:'debugWindow.MixDOMDebug.debug'})))),t.MixDOM.def(SectionHelper,{title:'Using the launcher script',name:'using-launcher'},t.MixDOM.def('p',{class:'style-text-center'},'Including the launcher script adds one function to the global window: ',t.MixDOM.def(Code,{code:'openMixDOMDebug'})),t.MixDOM.def(Aside,null,t.MixDOM.def(H3,null,'Global usage'),t.MixDOM.def('p',null,'The easiest way to use is to add the launcher script to the document, and then use it to open MixDOMDebug for the hosts you want to debug.'),t.MixDOM.def('ol',{class:'style-ui-list'},t.MixDOM.def('li',null,t.MixDOM.def(Small,{italic:!0,wide:!0},'1. '),'So first, include the launcher script ',t.MixDOM.def(Small,null,'(inside ',t.MixDOM.def(Code,{code:escapeHTML('<body>')}),')'),': ',t.MixDOM.def(Pre,{code:escapeHTML('<script type="text/javacript" src="https://unpkg.com/mix-dom-debug/launcher.global.js" />')})),t.MixDOM.def('li',null,t.MixDOM.def(Small,{italic:!0,wide:!0},'2. '),'And then use it to debug a Host instance: ',t.MixDOM.def(Pre,{code:'const debugWindow = window.openMixDOMDebug( host ); '.trim()})),t.MixDOM.def('li',null,t.MixDOM.def(Small,{italic:!0,wide:!0},'+ '),'Use the returned window to access the static class ',t.MixDOM.def(Small,null,'(after it\'s loaded)'),': ',t.MixDOM.def(Code,{code:'debugWindow.MixDOMDebug'})))),t.MixDOM.def(Aside,null,t.MixDOM.def(H3,null,'Adding global script by JS'),t.MixDOM.def('p',null,'You can also do this programmatically. ',t.MixDOM.def(Small,null,'(Of course, you only need to add the script to the document once.)')),t.MixDOM.def(Pre,{code:'\n// Prepare script.\nconst scriptUrl = "https://unpkg.com/mix-dom-debug/launcher.global.js";\nconst script = document.createElement("script");\nscript.setAttribute("type", "text/javascript");\nscript.setAttribute("src", scriptUrl);\n\n// Add a listener to start debugging when the script is loaded.\nlet debugWindow = null;\nscript.addEventListener("load", () => debugWindow = window.openMixDOMDebug(host));\n\n// Add the script to document.\ndocument.body.appendChild(script);\n\n'.trim()}),t.MixDOM.def('p',null,'If you have the ',t.MixDOM.def(Code,{code:'mix-dom-debug'}),' package downloaded / installed locally, you can of course point to its ',t.MixDOM.def(Code,{code:'"launcher.global.js"'}),'.')),t.MixDOM.def(Aside,null,t.MixDOM.def(H3,null,'Module usage ',t.MixDOM.def(Small,null,'(import/require)')),t.MixDOM.def('p',null,'You can also install the ',t.MixDOM.def(A,{href:'https://www.npmjs.com/package/mix-dom-debug'},'NPM package'),' and import the launcher as a sub module.'),t.MixDOM.def('ol',{class:'style-ui-list'},t.MixDOM.def('li',null,t.MixDOM.def(Small,{italic:!0,wide:!0},'1. '),'First, install ',t.MixDOM.def(Code,{code:'mix-dom-debug'}),' from the terminal ',t.MixDOM.def(Small,null,'(as a dev. dependency)'),': ',t.MixDOM.def(Pre,{code:escapeHTML('npm -i mix-dom-debug --save-dev')})),t.MixDOM.def('li',null,t.MixDOM.def(Small,{italic:!0,wide:!0},'2. '),'Then import ',t.MixDOM.def(Small,null,'(or require)'),' the launcher function: ',t.MixDOM.def(Pre,{code:'import { openMixDOMDebug } from "mix-dom-debug";'})),t.MixDOM.def('li',null,t.MixDOM.def(Small,{italic:!0,wide:!0},'3. '),'And finally hook it up in your code ',t.MixDOM.def(Small,null,'(with typing support)'),': ',t.MixDOM.def(Pre,{code:'openMixDOMDebug(host, debugSettings, appState);'})))),t.MixDOM.def(Aside,null,t.MixDOM.def(H3,null,'About launcher arguments'),t.MixDOM.def('p',null,'The ',t.MixDOM.def(Code,{code:'openMixDOMDebug'}),' function takes in 3 arguments, all of which are optional.'),t.MixDOM.def('ol',{class:'style-ui-list'},t.MixDOM.def('li',null,t.MixDOM.def(Small,{italic:!0,wide:!0},'1. '),'The host to debug: ',t.MixDOM.def(Code,{code:'host: Host | null'})),t.MixDOM.def('li',null,t.MixDOM.def(Small,{italic:!0,wide:!0},'2. '),'Debug settings: ',t.MixDOM.def(Pre,{code:'\ninterface DebugSettings {\n    // Persistent.\n    console?: Console;       // Default: window.console (in original window)\n    // App setup.\n    rootElement?: Element | string | null; // Defaults to "#app-root"\n    prettify?: boolean;      // Default: true. Adds Google prettify for syntax highlight.\n    beautify?: boolean;      // Default: true. Adds beautify JS for linebreaking and tabs.\n    addRoot?: boolean;       // Default: true for launcher, false normally.\n    useFadeIn?: boolean;     // Default: true for launcher, false normally.\n    fontUrl?: string;        // Default: "https://fonts.googleapis.com/css?family=Abel"\n    cssUrl?: string;         // Default: "https://unpkg.com/mix-dom-debug/MixDOMDebug.css"\n    // Only for launcher.\n    scriptUrl?: string;      // Default: "https://unpkg.com/mix-dom-debug/MixDOMDebug.js"\n    windowFeatures?: string; // Default: "toolbar=0,scrollbars=0,location=0,resizable=1"\n    windowTarget?: string;   // Default: "_blank"\n    onLoad?: (debug, host, debugWindow) => void;    // Default: undefined\n}\n'.trim()})),t.MixDOM.def('li',null,t.MixDOM.def(Small,{italic:!0,wide:!0},'3. '),'Initial app state: ',t.MixDOM.def(Pre,{code:'\ninterface DebugAppState {\n    theme?: "dark" | "light";                   // Default: "dark"\n    filter?: string;                            // Default: ""\n    selected?: MixDOMTreeNode[];                // Default: []\n    collapsed?: MixDOMTreeNode[];               // Default: []\n    includedSubHosts?: Host[] | boolean;        // Default: false\n    showCollapsed?: boolean;                    // Default: false\n    showParents?: boolean;                      // Default: false\n    showChildren?: boolean;                     // Default: false\n    hideUnmatched?: boolean;                    // Default: false\n    ignoreSelection?: boolean;                  // Default: false\n    ignoreFilter?: boolean;                     // Default: false\n    rowMode?: "select" | "select-tip" | "tip";  // Default: "select-tip"\n    hiddenTipSections?: TipSectionNames[];      // Default: []\n}'.trim()}),t.MixDOM.def(Pre,{code:'\ntype TipSectionNames = "heading" | "code" | "props" | "state" | "contexts" |\n    "settings" | "rendered-by" | "wired" | "remote" | "children" | "renders";\n'.trim()}))))),t.MixDOM.def(SectionHelper,{title:'Manual launching',name:'manual-launching'},t.MixDOM.def('p',{class:'style-text-center'},'Using the launcher is of course optional: you can just open up the debugger manually.'),t.MixDOM.def(Aside,null,t.MixDOM.def(H3,null,'Manually ',t.MixDOM.def(Small,null,'(without launcher script)')),t.MixDOM.def('p',null,'The below code shows ',t.MixDOM.def(Small,null,'(approximately)'),' what the ',t.MixDOM.def(Code,{code:'openMixDOMDebug'}),' function actually does.'),t.MixDOM.def(Pre,{code:'\nfunction openMixDOMDebug(host, debugSettings, appState) {\n\n    // Parse.\n    let { scriptUrl: sUrl, windowFeatures, windowTarget, onLoad, ...coreSettings } = {\n        console: window.console,\n        addRoot: true,\n        useFadeIn: true,\n        windowFeatures: "toolbar=0,scrollbars=0,location=0,resizable=1",\n        windowTarget: "_blank",\n        scriptUrl: "https://unpkg.com/mix-dom-debug/MixDOMDebug.js",\n        ...debugSettings\n    };\n    if (coreSettings.cssUrl === undefined)\n        coreSettings.cssUrl = sUrl.slice(0, sUrl.lastIndexOf("/") + 1) + "MixDOMDebug.css";\n\n    // Open a window.\n    const w = window.open(undefined, windowTarget, windowFeatures);\n\n    // Generate contents.\n    if (w) {\n\n        // Prepare script.\n        const script = w.document.createElement("script");\n        script.setAttribute("type", "text/javascript");\n        script.setAttribute("src", sUrl);\n\n        // Add load listener.\n        script.addEventListener("load", () => {\n            w.MixDOMDebug.startDebug(host, coreSettings, appState);\n        });\n        \n        // Add window close listener.\n        // .. We can use "beforeunload" to call a func inside,\n        // .. since we are not trying to prevent the unloading.\n        w.addEventListener("beforeunload", () => {\n            w.MixDOMDebug?.stopDebug(true); // True to skip context update.\n        });\n\n        // Add script.\n        w.document.body.appendChild(script);\n    }\n\n    // Return window.\n    return w;\n}\n'.trim()}))),t.MixDOM.def(SectionHelper,{title:'Render the app manually',name:'render-app'},t.MixDOM.def('p',{class:'style-text-center'},'Finally, you can include the whole debugger app with the ',t.MixDOM.def(A,{href:'https://www.npmjs.com/package/mix-dom-debug',target:'_blank'},'NPM package'),'.'),t.MixDOM.def(Aside,null,t.MixDOM.def(H3,null,'Import the app root'),t.MixDOM.def('p',null,'To render the app in a custom location within your app ',t.MixDOM.def(Small,null,'(instead of a new window)'),', import the ',t.MixDOM.def(Code,{code:'MixDOMDebug'}),' class, instantiate it and insert its own host ',t.MixDOM.def(Code,{code:'debug.ownHost'}),' inside your app.'),t.MixDOM.def('p',null,'Note that it\'s okay to insert the debugger host inside the host you want to debug - it will be cut out from debugging itself. The below JSX-example demonstrates the principles.'),t.MixDOM.def(Pre,{code:escapeHTML('\n// Imports.\nimport { MixDOM } from "mix-dom";\nimport { MixDOMDebug } from "mix-dom-debug";\n\n// Host to debug.\n// .. Note that you could insert debug.ownHost inside, too.\nconst UIAppToDebug = () => <div class="app-to-debug">...</div>;\nconst hostToDebug = new Host(<UIAppToDebug/>);\n\n// Initialize styles and optional scripts to this document.\nMixDOMDebug.initApp(); // Can define more options here.\n\n// Create a debug instance manually.\nconst debug = new MixDOMDebug(); // No need to give a container.\ndebug.setHost(hostToDebug);\n\n// Insert the debugger\'s own host inside your dev. app.\nconst UIDevApp = () => <div class="dev-app">{debug.ownHost}</div>;\nconst devHost = new Host(<UIDevApp/>);\n\n// Extra tips.\n// debug.setHost(host, settings, appState);     // Set host + update settings.\n// debug.updateSettings(settings, appState);    // Update settings.\n// debug.clearHost(host);                       // Stop debugging.\n\n'.trim())})))))},x=function UIApp(e,t,n){return t.state={theme:'dark',host:null},n.listenToData('state.theme','debug.host',((e,o)=>t.setState({theme:e,host:o})),[t.state.theme,t.state.host]),(e,t)=>o.MixDOM.def('div',{class:i.classNames('ui-app style-back-main style-front-main layout-fit-size flex-col','color-theme-'+t.theme,'layout-theme-default','transition-theme-default')},t.host?o.MixDOM.def(o.MixDOM.Fragment,null,o.MixDOM.def(m,{refreshId:e.refreshId}),o.MixDOM.def('div',{class:'flex-row layout-fit-width flex-grow layout-overflow-hidden'},o.MixDOM.def(h,{refreshId:e.refreshId,listClassName:'layout-padding-m layout-border-box'}))):o.MixDOM.def('div',{class:'flex-row layout-fit-width flex-grow layout-overflow-hidden'},o.MixDOM.def(UIAppInstructions,{refreshId:e.refreshId})),o.MixDOM.def(p.WithContent,null,o.MixDOM.def('div',{class:'popup-tip-container layout-abs-fill layout-z-high layout-overflow-hidden layout-no-pointer'},p.Content)))};var __rest=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&'function'==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};class MixDOMDebug{constructor(o){this.onUpdate=(e,t)=>{e||null===this.updateTimer&&(this.updateTimer=window.setTimeout((()=>{this.updateTimer=null,this.contexts.debug.setInData('iUpdate',(this.contexts.debug.data.iUpdate||0)+1)}),1))},this.updateTimer=null,this.refreshId={},this.contexts={debug:new e.Context({settings:this.getSettings(null,!1),host:null,iUpdate:0}),state:new e.Context({theme:'dark',filter:'',showCollapsed:!1,showParents:!1,showChildren:!1,hideUnmatched:!1,ignoreSelection:!1,ignoreFilter:!1,rowMode:'select-tip',shouldSelect:!0,noneCollapsed:!0,hiddenTipSections:[]})},this.contexts.state.listenTo('toggleTheme',(()=>this.contexts.state.setData({theme:'dark'===this.contexts.state.data.theme?'light':'dark'}))),this.contexts.state.listenTo('connectSubHost',((e,t)=>{e!==this.contexts.debug.data.host&&e!==this.ownHost&&(this.setHostListeners(e),t&&this.refresh())})),this.contexts.state.listenTo('disconnectSubHost',((e,t)=>{e!==this.contexts.debug.data.host&&e!==this.ownHost&&(this.clearHostListeners(e),t&&this.refresh())})),this.ownHost=new t.Host(t.newDef(x,{refreshId:this.refreshId}),o||null,{onlyRunInContainer:!0},this.contexts)}setHost(e,t,o){if(e===this.ownHost){return void function consoleWarn(e,...t){console.warn(...t),e&&e.console&&e.console!==console&&e.console.warn(...t)}(t?Object.assign(Object.assign({},this.contexts.debug.data.settings),t):this.contexts.debug.data.settings,'MixDOMDebug: Tried to debug self.',e)}const i=this.contexts.debug.data.host;i&&i===e?this.refresh():(i&&this.clearHostListeners(i),this.setHostListeners(e)),this.contexts.debug.setData({host:e,iUpdate:0}),this.updateSettings(t,o)}clearHost(){const e=this.contexts.debug.data.host;e&&(this.clearHostListeners(e),this.contexts.debug.setData({host:null,iUpdate:0}))}updateSettings(e,t){if(e&&this.contexts.debug.setInData('settings',this.getSettings(e)),t){const{selected:e,collapsed:o,includedSubHosts:i}=t,n=__rest(t,['selected','collapsed','includedSubHosts']);this.contexts.state.setData(Object.assign({},n)),e&&this.contexts.state.sendSignalAs('delay','modifySelected',e,'reset'),o&&this.contexts.state.sendSignalAs('delay','modifyCollapsed',o,'reset'),void 0!==i&&this.contexts.state.sendSignalAs('delay','modifySubHosts',i)}this.refresh()}refresh(e=!0){e&&(this.refreshId={}),this.ownHost.updateRoot(t.newDef(x,{refreshId:this.refreshId}))}getSettings(e,t=!0){return Object.assign(Object.assign({console:window.console},t?this.contexts.debug.data.settings:void 0),e)}clearHostListeners(e){e.services.renderCycle.unlistenTo('onFinish',this.onUpdate),consoleLog(this.contexts.debug.data.settings,'MixDOMDebug: Host removed',e)}setHostListeners(e){e.services.renderCycle.listenTo('onFinish',this.onUpdate,[e]),consoleLog(this.contexts.debug.data.settings,'MixDOMDebug: Host added',e)}}MixDOMDebug.debug=null,MixDOMDebug.stopDebug=e=>{if(MixDOMDebug.debug){const t=MixDOMDebug.debug.contexts,o=t.debug.data.host;o&&MixDOMDebug.debug.clearHostListeners(o),!e&&t.debug.setData({host:null}),MixDOMDebug.debug=null}},MixDOMDebug.startDebug=(e,t,o)=>{const i=t||{},{rootElement:n,cssUrl:s,fontUrl:l,prettify:r,beautify:a,addRoot:d,useFadeIn:c,onLoad:p}=i,u=__rest(i,['rootElement','cssUrl','fontUrl','prettify','beautify','addRoot','useFadeIn','onLoad']);if(MixDOMDebug.debug)return e?MixDOMDebug.debug.setHost(e,u,o):MixDOMDebug.debug.updateSettings(u,o),p&&p(MixDOMDebug.debug,e||null,window),MixDOMDebug.debug;MixDOMDebug.initApp({cssUrl:s,fontUrl:l,prettify:r,beautify:a,addRoot:d,useFadeIn:c},(()=>{MixDOMDebug.debug&&(e?MixDOMDebug.debug.setHost(e,u,o):MixDOMDebug.debug.updateSettings(u,o)),p&&p(MixDOMDebug.debug,e||null,window)}));const f=n&&n instanceof Element?n:null===n?null:document.body.querySelector(void 0===n?'#app-root':n);return MixDOMDebug.debug=new MixDOMDebug(f),MixDOMDebug.debug},MixDOMDebug.initApp=(e,t)=>{var o,i;e||(e={});const n=null!==(o=e.cssUrl)&&void 0!==o?o:'https://unpkg.com/mix-dom-debug/MixDOMDebug.css',l=null!==(i=e.fontUrl)&&void 0!==i?i:'https://fonts.googleapis.com/css?family=Abel',r=window.document,a=s;if(r.documentElement.setAttribute('lang','en'),e.addRoot){let e=r.body.querySelector('#app-root');e||(r.body.style.cssText='background: #222; margin: 0; padding: 0; width: 100%; height: 100%; font-family: \'Abel\', Arial, sans-serif; font-size: 16px;',e=r.createElement('div'),e.classList.add('ui'),e.id='app-root',r.body.appendChild(e))}const d=e.useFadeIn?function useFade(e){const t=e.createElement('div');return t.classList.add('ui'),t.id='app-hide',t.style.cssText='position: absolute; inset: 0; z-index: 1000; background: #222; opacity: 1; transition: opacity 150ms ease-in-out; pointer-events: none;',e.body.appendChild(t),()=>{const t=e.querySelector('#app-hide');t&&(e.body.style.removeProperty('background'),t.style.setProperty('opacity','0'),(e.defaultView||window).setTimeout((()=>{t.remove()}),150))}}(r):null;let c=r.head.querySelector('title');c||(c=r.createElement('title'),c.textContent='MixDOMDebug | Debugger for MixDOM library',r.head.appendChild(c));let p=r.head.querySelector('meta[name=description]');p||(p=r.createElement('meta'),p.setAttribute('name','description'),p.setAttribute('content','MixDOMDebug is an app for MixDOM library to debug a Host instance - shows the tree in details'),r.head.appendChild(p));let u=r.head.querySelector('meta[http-equiv=content-type]');u||(u=r.createElement('meta'),u.setAttribute('http-equiv','content-type'),u.setAttribute('content','text/html'),u.setAttribute('charset','utf-8'),r.head.appendChild(u));let f=r.head.querySelector('meta[name=viewport]');f||(f=r.createElement('meta'),f.setAttribute('name','viewport'),f.setAttribute('content','width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no'),r.head.appendChild(f));let M=0;const oneLoaded=()=>{--M>0||(d&&d(),t&&t())};let g=!1;const h=[],m=[...r.head.querySelectorAll('link[rel=stylesheet]')],x=`${n}?v=${a}`;let y=m.find((e=>e.getAttribute('href')===x));y||(y=r.createElement('link'),y.setAttribute('rel','stylesheet'),y.setAttribute('type','text/css'),y.setAttribute('href',x),h.push(y),M++,g=!0);let b=m.find((e=>e.getAttribute('href')===l));if(!b){b=r.createElement('link'),b.setAttribute('rel','stylesheet'),b.setAttribute('type','text/css'),b.setAttribute('href',l),h.push(b),M++;const fontLoaded=()=>{document.fonts.removeEventListener('loadingdone',fontLoaded),oneLoaded()};document.fonts.addEventListener('loadingdone',fontLoaded)}const D=[!1!==e.prettify?'https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/prettify.js':'',!1!==e.beautify?'https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.15.1/beautify.min.js':''].filter((e=>e)),O=[...r.body.querySelectorAll('script')].map((e=>e.getAttribute('src'))),w=D.map((e=>{if(O.includes(e))return null;M++;const t=r.createElement('script');return t.setAttribute('type','text/javascript'),t.setAttribute('src',e),t.onload=oneLoaded,t})).filter((e=>e));if(h[0]||w[0]){for(const e of h)r.head.appendChild(e);for(const e of w)r.body.appendChild(e);if(g){const e=document.createElement('div');e.style.cssText='display: none;',e.classList.add('style-disabled'),r.body.appendChild(e);const t=window.setInterval((()=>{'1'!==window.getComputedStyle(e).opacity&&(e.remove(),window.clearInterval(t),oneLoaded())}),100)}}else oneLoaded()};var y=Object.freeze({__proto__:null,MixDOMDebug});module.exports=y;
